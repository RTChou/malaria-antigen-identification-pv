<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Model comparisons | Malaria vaccine antigen identification for Plasmodium vivax</title>
  <meta name="description" content="Section 4 Model comparisons | Malaria vaccine antigen identification for Plasmodium vivax" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Model comparisons | Malaria vaccine antigen identification for Plasmodium vivax" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Model comparisons | Malaria vaccine antigen identification for Plasmodium vivax" />
  
  
  

<meta name="author" content="Renee Ti Chou" />


<meta name="date" content="2023-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_03_model_evaluation.html"/>
<link rel="next" href="id_05_model_interpretation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.12.1/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.12.1/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<!-- https://stackoverflow.com/questions/45360998/code-folding-in-bookdown -->
<script type="text/javascript" src="js/transition.js"></script>
<script type="text/javascript" src="js/dropdown.js"></script>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><i>Positive-unlabeled learning for Pv RV</i></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html"><i class="fa fa-check"></i><b>1</b> Data engineering</a>
<ul>
<li class="chapter" data-level="1.1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#purf-package-installization"><i class="fa fa-check"></i><b>1.1</b> <code>purf</code> package installization</a></li>
<li class="chapter" data-level="1.2" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#retrieving-p.-vivax-protein-variables"><i class="fa fa-check"></i><b>1.2</b> Retrieving <em>P. vivax</em> protein variables</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#immunological-data-sets"><i class="fa fa-check"></i><b>1.2.1</b> Immunological data sets</a></li>
<li class="chapter" data-level="1.2.2" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#proteomic-data-sets"><i class="fa fa-check"></i><b>1.2.2</b> Proteomic data sets</a></li>
<li class="chapter" data-level="1.2.3" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#structural-data-sets"><i class="fa fa-check"></i><b>1.2.3</b> Structural data sets</a></li>
<li class="chapter" data-level="1.2.4" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#genomic-data-sets"><i class="fa fa-check"></i><b>1.2.4</b> Genomic data sets</a></li>
<li class="chapter" data-level="1.2.5" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#final-assembly"><i class="fa fa-check"></i><b>1.2.5</b> Final assembly</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#generating-ml-input"><i class="fa fa-check"></i><b>1.3</b> Generating ML input</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="id_02_model_training.html"><a href="id_02_model_training.html"><i class="fa fa-check"></i><b>2</b> Model training</a>
<ul>
<li class="chapter" data-level="2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#hyper-parameter-tuning-for-purf"><i class="fa fa-check"></i><b>2.1</b> Hyper-parameter tuning for PURF</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#analysis"><i class="fa fa-check"></i><b>2.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-data-set"><i class="fa fa-check"></i><b>2.1.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-pf-combined-data-set"><i class="fa fa-check"></i><b>2.1.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="2.1.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#plotting"><i class="fa fa-check"></i><b>2.1.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="2.1.2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-data-set-1"><i class="fa fa-check"></i><b>2.1.2.1</b> Pv data set</a></li>
<li class="chapter" data-level="2.1.2.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#bimodal-distribution-plot"><i class="fa fa-check"></i><b>2.1.2.2</b> Bimodal distribution plot</a></li>
<li class="chapter" data-level="2.1.2.3" data-path="id_02_model_training.html"><a href="id_02_model_training.html#known-antigen-ranking"><i class="fa fa-check"></i><b>2.1.2.3</b> Known antigen ranking</a></li>
<li class="chapter" data-level="2.1.2.4" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-pf-combined-data-set-1"><i class="fa fa-check"></i><b>2.1.2.4</b> Pv + Pf combined data set</a></li>
<li class="chapter" data-level="2.1.2.5" data-path="id_02_model_training.html"><a href="id_02_model_training.html#bimodal-distribution-plot-1"><i class="fa fa-check"></i><b>2.1.2.5</b> Bimodal distribution plot</a></li>
<li class="chapter" data-level="2.1.2.6" data-path="id_02_model_training.html"><a href="id_02_model_training.html#known-antigen-ranking-1"><i class="fa fa-check"></i><b>2.1.2.6</b> Known antigen ranking</a></li>
</ul></li>
<li class="chapter" data-level="2.1.3" data-path="id_02_model_training.html"><a href="id_02_model_training.html#results-for-positive-level-0.5"><i class="fa fa-check"></i><b>2.1.3</b> Results for positive level = 0.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html"><i class="fa fa-check"></i><b>3</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#known-antigen-prediction-accuracy"><i class="fa fa-check"></i><b>3.1</b> Known antigen prediction accuracy</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#analysis-1"><i class="fa fa-check"></i><b>3.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="3.1.1.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pv-model-cross-species-predictions"><i class="fa fa-check"></i><b>3.1.1.1</b> Pv model cross-species predictions</a></li>
<li class="chapter" data-level="3.1.1.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pf-model-cross-species-predictions"><i class="fa fa-check"></i><b>3.1.1.2</b> Pf model cross-species predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#adversarial-controls"><i class="fa fa-check"></i><b>3.2</b> Adversarial controls</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#analysis-2"><i class="fa fa-check"></i><b>3.2.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="3.2.1.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pv-data-set-2"><i class="fa fa-check"></i><b>3.2.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="3.2.1.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pv-pf-combined-data-set-2"><i class="fa fa-check"></i><b>3.2.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="3.2.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#plotting-1"><i class="fa fa-check"></i><b>3.2.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="3.2.2.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#mean-differences-in-scores"><i class="fa fa-check"></i><b>3.2.2.1</b> Mean differences in scores</a></li>
<li class="chapter" data-level="3.2.2.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#investigation-of-known-antigen-groups"><i class="fa fa-check"></i><b>3.2.2.2</b> Investigation of known antigen groups</a></li>
<li class="chapter" data-level="3.2.2.3" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#labeled-known-antigen-accuracies"><i class="fa fa-check"></i><b>3.2.2.3</b> Labeled known antigen accuracies</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html"><i class="fa fa-check"></i><b>4</b> Model comparisons</a>
<ul>
<li class="chapter" data-level="4.1" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#known-antigen-score-comparisons"><i class="fa fa-check"></i><b>4.1</b> Known antigen score comparisons</a></li>
<li class="chapter" data-level="4.2" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#known-antigen-prediction-summary"><i class="fa fa-check"></i><b>4.2</b> Known antigen prediction summary</a></li>
<li class="chapter" data-level="4.3" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#score-and-species-association"><i class="fa fa-check"></i><b>4.3</b> Score and species association</a></li>
<li class="chapter" data-level="4.4" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#tree-depth-analysis"><i class="fa fa-check"></i><b>4.4</b> Tree depth analysis</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#analysis-3"><i class="fa fa-check"></i><b>4.4.1</b> Analysis</a></li>
<li class="chapter" data-level="4.4.2" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#plotting-2"><i class="fa fa-check"></i><b>4.4.2</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html"><i class="fa fa-check"></i><b>5</b> Model interpretation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#proximity-matrix-calculation"><i class="fa fa-check"></i><b>5.1</b> Proximity matrix calculation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-4"><i class="fa fa-check"></i><b>5.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="5.1.1.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-data-set-3"><i class="fa fa-check"></i><b>5.1.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="5.1.1.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-3"><i class="fa fa-check"></i><b>5.1.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="5.1.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#plotting-3"><i class="fa fa-check"></i><b>5.1.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="5.1.2.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-4"><i class="fa fa-check"></i><b>5.1.2.1</b> Pv + Pf combined data set</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#clustering-of-predicted-positives"><i class="fa fa-check"></i><b>5.2</b> Clustering of predicted positives</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-5"><i class="fa fa-check"></i><b>5.2.1</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#comparison-of-amino-acid-frequencies-between-species"><i class="fa fa-check"></i><b>5.3</b> Comparison of amino acid frequencies between species</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-6"><i class="fa fa-check"></i><b>5.3.1</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#variable-importance"><i class="fa fa-check"></i><b>5.4</b> Variable importance</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-7"><i class="fa fa-check"></i><b>5.4.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="5.4.1.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-data-set-4"><i class="fa fa-check"></i><b>5.4.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="5.4.1.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-5"><i class="fa fa-check"></i><b>5.4.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="5.4.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#plotting-4"><i class="fa fa-check"></i><b>5.4.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="5.4.2.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-data-set-5"><i class="fa fa-check"></i><b>5.4.2.1</b> Pv data set</a></li>
<li class="chapter" data-level="5.4.2.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-6"><i class="fa fa-check"></i><b>5.4.2.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="5.4.3" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#comparison-of-top-10-important-variables"><i class="fa fa-check"></i><b>5.4.3</b> Comparison of top 10 important variables</a>
<ul>
<li class="chapter" data-level="5.4.3.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#venn-diagram"><i class="fa fa-check"></i><b>5.4.3.1</b> Venn diagram</a></li>
<li class="chapter" data-level="5.4.3.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#top-10-variables-from-combined-model"><i class="fa fa-check"></i><b>5.4.3.2</b> Top 10 variables from combined model</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html"><i class="fa fa-check"></i><b>6</b> Top candidate comparisons</a>
<ul>
<li class="chapter" data-level="6.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#clustering-analysis"><i class="fa fa-check"></i><b>6.1</b> Clustering analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#analysis-8"><i class="fa fa-check"></i><b>6.1.1</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#gene-ontology-analysis"><i class="fa fa-check"></i><b>6.2</b> Gene ontology analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#analysis-9"><i class="fa fa-check"></i><b>6.2.1</b> Analysis</a></li>
<li class="chapter" data-level="6.2.2" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#plotting-5"><i class="fa fa-check"></i><b>6.2.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#candidate-antigen-characterization"><i class="fa fa-check"></i><b>6.3</b> Candidate antigen characterization</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#processing-table"><i class="fa fa-check"></i><b>6.3.1</b> Processing table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="id_07_summary_of_candidates.html"><a href="id_07_summary_of_candidates.html"><i class="fa fa-check"></i><b>7</b> Summary of candidates</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Malaria vaccine antigen identification for <em>Plasmodium vivax</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="id_04_model_comparisons" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Model comparisons<a href="id_04_model_comparisons.html#id_04_model_comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="known-antigen-score-comparisons" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Known antigen score comparisons<a href="id_04_model_comparisons.html#known-antigen-score-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb74-1"><a href="id_04_model_comparisons.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb74-2"><a href="id_04_model_comparisons.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb74-3"><a href="id_04_model_comparisons.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb74-4"><a href="id_04_model_comparisons.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghalves)</span>
<span id="cb74-5"><a href="id_04_model_comparisons.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb75-1"><a href="id_04_model_comparisons.html#cb75-1" aria-hidden="true" tabindex="-1"></a>pv_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pv_known_antigen_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb75-2"><a href="id_04_model_comparisons.html#cb75-2" aria-hidden="true" tabindex="-1"></a>pv_unl_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pv_unlabeled_protein_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb75-3"><a href="id_04_model_comparisons.html#cb75-3" aria-hidden="true" tabindex="-1"></a>pv_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb75-4"><a href="id_04_model_comparisons.html#cb75-4" aria-hidden="true" tabindex="-1"></a>pv_unl_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-5"><a href="id_04_model_comparisons.html#cb75-5" aria-hidden="true" tabindex="-1"></a>data_ <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">rbind</span>(pv_scores, pv_unl_scores), <span class="at">id.vars =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb75-6"><a href="id_04_model_comparisons.html#cb75-6" aria-hidden="true" tabindex="-1"></a>data_<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_<span class="sc">$</span>variable, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb75-7"><a href="id_04_model_comparisons.html#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pf_single_model&quot;</span>,</span>
<span id="cb75-8"><a href="id_04_model_comparisons.html#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pv_single_model&quot;</span>, <span class="st">&quot;pv_pf_pos&quot;</span>,</span>
<span id="cb75-9"><a href="id_04_model_comparisons.html#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pfpv_combined_model&quot;</span>,</span>
<span id="cb75-10"><a href="id_04_model_comparisons.html#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pv_pf_unl&quot;</span></span>
<span id="cb75-11"><a href="id_04_model_comparisons.html#cb75-11" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb75-12"><a href="id_04_model_comparisons.html#cb75-12" aria-hidden="true" tabindex="-1"></a>data_<span class="sc">$</span>label[data_<span class="sc">$</span>value <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> data_<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb75-13"><a href="id_04_model_comparisons.html#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb75-14"><a href="id_04_model_comparisons.html#cb75-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb75-15"><a href="id_04_model_comparisons.html#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-16"><a href="id_04_model_comparisons.html#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb75-17"><a href="id_04_model_comparisons.html#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb75-18"><a href="id_04_model_comparisons.html#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_linewidth =</span> <span class="fl">0.2</span>, <span class="at">adjust =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb75-19"><a href="id_04_model_comparisons.html#cb75-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">normalize =</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb75-20"><a href="id_04_model_comparisons.html#cb75-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-21"><a href="id_04_model_comparisons.html#cb75-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb75-22"><a href="id_04_model_comparisons.html#cb75-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.color =</span> <span class="cn">NA</span>,</span>
<span id="cb75-23"><a href="id_04_model_comparisons.html#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.3</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb75-24"><a href="id_04_model_comparisons.html#cb75-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-25"><a href="id_04_model_comparisons.html#cb75-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_point</span>(</span>
<span id="cb75-26"><a href="id_04_model_comparisons.html#cb75-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_[data_<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">2</span>, ], <span class="at">fill =</span> <span class="st">&quot;#FCB40A&quot;</span>, <span class="at">side =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb75-27"><a href="id_04_model_comparisons.html#cb75-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb75-28"><a href="id_04_model_comparisons.html#cb75-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-29"><a href="id_04_model_comparisons.html#cb75-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb75-30"><a href="id_04_model_comparisons.html#cb75-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FCB40A&quot;</span>, <span class="st">&quot;#FF007F&quot;</span>, <span class="st">&quot;#0080FF&quot;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb75-31"><a href="id_04_model_comparisons.html#cb75-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Known antigen&quot;</span>, <span class="st">&quot;Predicted antigen&quot;</span>, <span class="st">&quot;Predicted non-antigen&quot;</span>)</span>
<span id="cb75-32"><a href="id_04_model_comparisons.html#cb75-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-33"><a href="id_04_model_comparisons.html#cb75-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb75-34"><a href="id_04_model_comparisons.html#cb75-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FCB40A&quot;</span>, <span class="st">&quot;#FF007F&quot;</span>, <span class="st">&quot;#0080FF&quot;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb75-35"><a href="id_04_model_comparisons.html#cb75-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Known antigen&quot;</span>, <span class="st">&quot;Predicted antigen&quot;</span>, <span class="st">&quot;Predicted non-antigen&quot;</span>)</span>
<span id="cb75-36"><a href="id_04_model_comparisons.html#cb75-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-37"><a href="id_04_model_comparisons.html#cb75-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb75-38"><a href="id_04_model_comparisons.html#cb75-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb75-39"><a href="id_04_model_comparisons.html#cb75-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb75-40"><a href="id_04_model_comparisons.html#cb75-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;pf_single_model&quot;</span>, <span class="st">&quot;pv_single_model&quot;</span>, <span class="st">&quot;pv_pf_pos&quot;</span>,</span>
<span id="cb75-41"><a href="id_04_model_comparisons.html#cb75-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;pfpv_combined_model&quot;</span>, <span class="st">&quot;pv_pf_unl&quot;</span></span>
<span id="cb75-42"><a href="id_04_model_comparisons.html#cb75-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb75-43"><a href="id_04_model_comparisons.html#cb75-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb75-44"><a href="id_04_model_comparisons.html#cb75-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Heterologous model&quot;</span>, <span class="st">&quot;Autologous model&quot;</span>,</span>
<span id="cb75-45"><a href="id_04_model_comparisons.html#cb75-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Autologous with</span><span class="sc">\n</span><span class="st"> heterologous positives model&quot;</span>,</span>
<span id="cb75-46"><a href="id_04_model_comparisons.html#cb75-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Combined model&quot;</span>,</span>
<span id="cb75-47"><a href="id_04_model_comparisons.html#cb75-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Autologous with</span><span class="sc">\n</span><span class="st"> heterologous unlabeled model&quot;</span></span>
<span id="cb75-48"><a href="id_04_model_comparisons.html#cb75-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb75-49"><a href="id_04_model_comparisons.html#cb75-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> rev</span>
<span id="cb75-50"><a href="id_04_model_comparisons.html#cb75-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-51"><a href="id_04_model_comparisons.html#cb75-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb75-52"><a href="id_04_model_comparisons.html#cb75-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb75-53"><a href="id_04_model_comparisons.html#cb75-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-54"><a href="id_04_model_comparisons.html#cb75-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-55"><a href="id_04_model_comparisons.html#cb75-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb75-56"><a href="id_04_model_comparisons.html#cb75-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-57"><a href="id_04_model_comparisons.html#cb75-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb75-58"><a href="id_04_model_comparisons.html#cb75-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb75-59"><a href="id_04_model_comparisons.html#cb75-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb75-60"><a href="id_04_model_comparisons.html#cb75-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb75-61"><a href="id_04_model_comparisons.html#cb75-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-62"><a href="id_04_model_comparisons.html#cb75-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb75-63"><a href="id_04_model_comparisons.html#cb75-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Score (proportion of votes)&quot;</span>)</span>
<span id="cb75-64"><a href="id_04_model_comparisons.html#cb75-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-65"><a href="id_04_model_comparisons.html#cb75-65" aria-hidden="true" tabindex="-1"></a>legend <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(p2 <span class="sc">+</span></span>
<span id="cb75-66"><a href="id_04_model_comparisons.html#cb75-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb75-67"><a href="id_04_model_comparisons.html#cb75-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb75-68"><a href="id_04_model_comparisons.html#cb75-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb75-69"><a href="id_04_model_comparisons.html#cb75-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb75-70"><a href="id_04_model_comparisons.html#cb75-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-71"><a href="id_04_model_comparisons.html#cb75-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb76-1"><a href="id_04_model_comparisons.html#cb76-1" aria-hidden="true" tabindex="-1"></a>pf_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_known_antigen_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb76-2"><a href="id_04_model_comparisons.html#cb76-2" aria-hidden="true" tabindex="-1"></a>pf_unl_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_unlabeled_protein_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb76-3"><a href="id_04_model_comparisons.html#cb76-3" aria-hidden="true" tabindex="-1"></a>pf_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-4"><a href="id_04_model_comparisons.html#cb76-4" aria-hidden="true" tabindex="-1"></a>pf_unl_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-5"><a href="id_04_model_comparisons.html#cb76-5" aria-hidden="true" tabindex="-1"></a>data_ <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">rbind</span>(pf_scores, pf_unl_scores), <span class="at">id.vars =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb76-6"><a href="id_04_model_comparisons.html#cb76-6" aria-hidden="true" tabindex="-1"></a>data_<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_<span class="sc">$</span>variable, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb76-7"><a href="id_04_model_comparisons.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pv_single_model&quot;</span>,</span>
<span id="cb76-8"><a href="id_04_model_comparisons.html#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pf_single_model&quot;</span>, <span class="st">&quot;pf_pv_pos&quot;</span>,</span>
<span id="cb76-9"><a href="id_04_model_comparisons.html#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pfpv_combined_model&quot;</span>,</span>
<span id="cb76-10"><a href="id_04_model_comparisons.html#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pf_pv_unl&quot;</span></span>
<span id="cb76-11"><a href="id_04_model_comparisons.html#cb76-11" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb76-12"><a href="id_04_model_comparisons.html#cb76-12" aria-hidden="true" tabindex="-1"></a>data_<span class="sc">$</span>label[data_<span class="sc">$</span>value <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> data_<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-13"><a href="id_04_model_comparisons.html#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb76-14"><a href="id_04_model_comparisons.html#cb76-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb76-15"><a href="id_04_model_comparisons.html#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-16"><a href="id_04_model_comparisons.html#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb76-17"><a href="id_04_model_comparisons.html#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb76-18"><a href="id_04_model_comparisons.html#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_linewidth =</span> <span class="fl">0.2</span>, <span class="at">adjust =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb76-19"><a href="id_04_model_comparisons.html#cb76-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">normalize =</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb76-20"><a href="id_04_model_comparisons.html#cb76-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-21"><a href="id_04_model_comparisons.html#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb76-22"><a href="id_04_model_comparisons.html#cb76-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.color =</span> <span class="cn">NA</span>,</span>
<span id="cb76-23"><a href="id_04_model_comparisons.html#cb76-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.3</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb76-24"><a href="id_04_model_comparisons.html#cb76-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-25"><a href="id_04_model_comparisons.html#cb76-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_point</span>(</span>
<span id="cb76-26"><a href="id_04_model_comparisons.html#cb76-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_[data_<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">2</span>, ], <span class="at">fill =</span> <span class="st">&quot;#FCB40A&quot;</span>, <span class="at">side =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb76-27"><a href="id_04_model_comparisons.html#cb76-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb76-28"><a href="id_04_model_comparisons.html#cb76-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-29"><a href="id_04_model_comparisons.html#cb76-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb76-30"><a href="id_04_model_comparisons.html#cb76-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FCB40A&quot;</span>, <span class="st">&quot;#FF007F&quot;</span>, <span class="st">&quot;#0080FF&quot;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb76-31"><a href="id_04_model_comparisons.html#cb76-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Known antigen&quot;</span>, <span class="st">&quot;Predicted antigen&quot;</span>, <span class="st">&quot;Predicted non-antigen&quot;</span>)</span>
<span id="cb76-32"><a href="id_04_model_comparisons.html#cb76-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-33"><a href="id_04_model_comparisons.html#cb76-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb76-34"><a href="id_04_model_comparisons.html#cb76-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#FCB40A&quot;</span>, <span class="st">&quot;#FF007F&quot;</span>, <span class="st">&quot;#0080FF&quot;</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb76-35"><a href="id_04_model_comparisons.html#cb76-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Known antigen&quot;</span>, <span class="st">&quot;Predicted antigen&quot;</span>, <span class="st">&quot;Predicted non-antigen&quot;</span>)</span>
<span id="cb76-36"><a href="id_04_model_comparisons.html#cb76-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-37"><a href="id_04_model_comparisons.html#cb76-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb76-38"><a href="id_04_model_comparisons.html#cb76-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb76-39"><a href="id_04_model_comparisons.html#cb76-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb76-40"><a href="id_04_model_comparisons.html#cb76-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;pv_single_model&quot;</span>, <span class="st">&quot;pf_single_model&quot;</span>, <span class="st">&quot;pf_pv_pos&quot;</span>,</span>
<span id="cb76-41"><a href="id_04_model_comparisons.html#cb76-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;pfpv_combined_model&quot;</span>, <span class="st">&quot;pf_pv_unl&quot;</span></span>
<span id="cb76-42"><a href="id_04_model_comparisons.html#cb76-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb76-43"><a href="id_04_model_comparisons.html#cb76-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb76-44"><a href="id_04_model_comparisons.html#cb76-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Heterologous model&quot;</span>, <span class="st">&quot;Autologous model&quot;</span>,</span>
<span id="cb76-45"><a href="id_04_model_comparisons.html#cb76-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Autologous with</span><span class="sc">\n</span><span class="st"> heterologous positives model&quot;</span>,</span>
<span id="cb76-46"><a href="id_04_model_comparisons.html#cb76-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Combined model&quot;</span>,</span>
<span id="cb76-47"><a href="id_04_model_comparisons.html#cb76-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Autologous with</span><span class="sc">\n</span><span class="st"> heterologous unlabeled model&quot;</span></span>
<span id="cb76-48"><a href="id_04_model_comparisons.html#cb76-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb76-49"><a href="id_04_model_comparisons.html#cb76-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> rev</span>
<span id="cb76-50"><a href="id_04_model_comparisons.html#cb76-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-51"><a href="id_04_model_comparisons.html#cb76-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb76-52"><a href="id_04_model_comparisons.html#cb76-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb76-53"><a href="id_04_model_comparisons.html#cb76-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb76-54"><a href="id_04_model_comparisons.html#cb76-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb76-55"><a href="id_04_model_comparisons.html#cb76-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-56"><a href="id_04_model_comparisons.html#cb76-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb76-57"><a href="id_04_model_comparisons.html#cb76-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-58"><a href="id_04_model_comparisons.html#cb76-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-59"><a href="id_04_model_comparisons.html#cb76-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb76-60"><a href="id_04_model_comparisons.html#cb76-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb76-61"><a href="id_04_model_comparisons.html#cb76-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-62"><a href="id_04_model_comparisons.html#cb76-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb76-63"><a href="id_04_model_comparisons.html#cb76-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-64"><a href="id_04_model_comparisons.html#cb76-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb76-65"><a href="id_04_model_comparisons.html#cb76-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Score (proportion of votes)&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb77-1"><a href="id_04_model_comparisons.html#cb77-1" aria-hidden="true" tabindex="-1"></a>p_combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1, p2, <span class="fu">plot_grid</span>(<span class="cn">NULL</span>, legend, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)),</span>
<span id="cb77-2"><a href="id_04_model_comparisons.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb77-3"><a href="id_04_model_comparisons.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb77-4"><a href="id_04_model_comparisons.html#cb77-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-5"><a href="id_04_model_comparisons.html#cb77-5" aria-hidden="true" tabindex="-1"></a>p_combined</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb78-1"><a href="id_04_model_comparisons.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">&quot;./figures/Fig 2.png&quot;</span>, <span class="at">width =</span> <span class="dv">7500</span>, <span class="at">height =</span> <span class="dv">4000</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb78-2"><a href="id_04_model_comparisons.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_combined)</span>
<span id="cb78-3"><a href="id_04_model_comparisons.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb78-4"><a href="id_04_model_comparisons.html#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="id_04_model_comparisons.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;../figures/Fig 2.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb78-6"><a href="id_04_model_comparisons.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_combined)</span>
<span id="cb78-7"><a href="id_04_model_comparisons.html#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figures/Fig%202.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="known-antigen-prediction-summary" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Known antigen prediction summary<a href="id_04_model_comparisons.html#known-antigen-prediction-summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb79-1"><a href="id_04_model_comparisons.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb79-2"><a href="id_04_model_comparisons.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb80-1"><a href="id_04_model_comparisons.html#cb80-1" aria-hidden="true" tabindex="-1"></a>pv_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pv_known_antigen_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb80-2"><a href="id_04_model_comparisons.html#cb80-2" aria-hidden="true" tabindex="-1"></a>pv_unl_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pv_unlabeled_protein_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb80-3"><a href="id_04_model_comparisons.html#cb80-3" aria-hidden="true" tabindex="-1"></a>pv_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb80-4"><a href="id_04_model_comparisons.html#cb80-4" aria-hidden="true" tabindex="-1"></a>pv_unl_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-5"><a href="id_04_model_comparisons.html#cb80-5" aria-hidden="true" tabindex="-1"></a>pv_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pv_scores, pv_unl_scores)</span>
<span id="cb80-6"><a href="id_04_model_comparisons.html#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="id_04_model_comparisons.html#cb80-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb80-8"><a href="id_04_model_comparisons.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;antigen_label&quot;</span> <span class="ot">=</span> pv_all<span class="sc">$</span>label,</span>
<span id="cb80-9"><a href="id_04_model_comparisons.html#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Heterologous model&quot;</span> <span class="ot">=</span> pv_all<span class="sc">$</span>pf_single_model,</span>
<span id="cb80-10"><a href="id_04_model_comparisons.html#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Autologous model&quot;</span> <span class="ot">=</span> pv_all<span class="sc">$</span>pv_single_model,</span>
<span id="cb80-11"><a href="id_04_model_comparisons.html#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Autologous with heterologous positives model&quot;</span> <span class="ot">=</span> pv_all<span class="sc">$</span>pv_pf_pos,</span>
<span id="cb80-12"><a href="id_04_model_comparisons.html#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Combined model&quot;</span> <span class="ot">=</span> pv_all<span class="sc">$</span>pfpv_combined_model,</span>
<span id="cb80-13"><a href="id_04_model_comparisons.html#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Autologous with heterologous unlabeled model&quot;</span> <span class="ot">=</span> pv_all<span class="sc">$</span>pv_pf_unl,</span>
<span id="cb80-14"><a href="id_04_model_comparisons.html#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb80-15"><a href="id_04_model_comparisons.html#cb80-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-16"><a href="id_04_model_comparisons.html#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="id_04_model_comparisons.html#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percent rank for labeled positives</span></span>
<span id="cb80-18"><a href="id_04_model_comparisons.html#cb80-18" aria-hidden="true" tabindex="-1"></a>model_names <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb80-19"><a href="id_04_model_comparisons.html#cb80-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb80-20"><a href="id_04_model_comparisons.html#cb80-20" aria-hidden="true" tabindex="-1"></a>percent_rank <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb80-21"><a href="id_04_model_comparisons.html#cb80-21" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb80-22"><a href="id_04_model_comparisons.html#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (model <span class="cf">in</span> <span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>]) {</span>
<span id="cb80-23"><a href="id_04_model_comparisons.html#cb80-23" aria-hidden="true" tabindex="-1"></a>  data_ <span class="ot">&lt;-</span> data[<span class="fu">c</span>(<span class="st">&quot;antigen_label&quot;</span>, model)]</span>
<span id="cb80-24"><a href="id_04_model_comparisons.html#cb80-24" aria-hidden="true" tabindex="-1"></a>  percent_rank_ <span class="ot">&lt;-</span> (<span class="fu">rank</span>(data_[[model]]) <span class="sc">/</span> <span class="fu">nrow</span>(data))[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb80-25"><a href="id_04_model_comparisons.html#cb80-25" aria-hidden="true" tabindex="-1"></a>  percent_rank <span class="ot">&lt;-</span> <span class="fu">c</span>(percent_rank, percent_rank_[<span class="fu">order</span>(<span class="sc">-</span>percent_rank_)])</span>
<span id="cb80-26"><a href="id_04_model_comparisons.html#cb80-26" aria-hidden="true" tabindex="-1"></a>  data_ <span class="ot">&lt;-</span> data_[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb80-27"><a href="id_04_model_comparisons.html#cb80-27" aria-hidden="true" tabindex="-1"></a>  data_ <span class="ot">&lt;-</span> data_[<span class="fu">order</span>(<span class="sc">-</span>percent_rank_), ]</span>
<span id="cb80-28"><a href="id_04_model_comparisons.html#cb80-28" aria-hidden="true" tabindex="-1"></a>  x_ <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_) <span class="sc">/</span> <span class="fu">nrow</span>(data_)</span>
<span id="cb80-29"><a href="id_04_model_comparisons.html#cb80-29" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, x_)</span>
<span id="cb80-30"><a href="id_04_model_comparisons.html#cb80-30" aria-hidden="true" tabindex="-1"></a>  model_names <span class="ot">&lt;-</span> <span class="fu">c</span>(model_names, <span class="fu">rep</span>(model, <span class="fu">nrow</span>(data_)))</span>
<span id="cb80-31"><a href="id_04_model_comparisons.html#cb80-31" aria-hidden="true" tabindex="-1"></a>  auc <span class="ot">&lt;-</span> <span class="fu">c</span>(auc, <span class="fu">round</span>(<span class="fu">trapz</span>(<span class="fu">c</span>(<span class="dv">0</span>, x_, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, percent_rank_, <span class="dv">0</span>)), <span class="dv">2</span>))</span>
<span id="cb80-32"><a href="id_04_model_comparisons.html#cb80-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;EPR: &quot;</span>, <span class="fu">sum</span>(data_[[model]] <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">nrow</span>(data_), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb80-33"><a href="id_04_model_comparisons.html#cb80-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-34"><a href="id_04_model_comparisons.html#cb80-34" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(auc) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb80-35"><a href="id_04_model_comparisons.html#cb80-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-36"><a href="id_04_model_comparisons.html#cb80-36" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> model_names, <span class="at">x =</span> x, <span class="at">percent_rank =</span> percent_rank)</span>
<span id="cb80-37"><a href="id_04_model_comparisons.html#cb80-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-38"><a href="id_04_model_comparisons.html#cb80-38" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(res, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">percent_rank</span><span class="st">`</span>, <span class="at">group =</span> model)) <span class="sc">+</span></span>
<span id="cb80-39"><a href="id_04_model_comparisons.html#cb80-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-40"><a href="id_04_model_comparisons.html#cb80-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-41"><a href="id_04_model_comparisons.html#cb80-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> model),</span>
<span id="cb80-42"><a href="id_04_model_comparisons.html#cb80-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>,</span>
<span id="cb80-43"><a href="id_04_model_comparisons.html#cb80-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb80-44"><a href="id_04_model_comparisons.html#cb80-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-45"><a href="id_04_model_comparisons.html#cb80-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_jco</span>(</span>
<span id="cb80-46"><a href="id_04_model_comparisons.html#cb80-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>][<span class="fu">order</span>(<span class="sc">-</span>auc)],</span>
<span id="cb80-47"><a href="id_04_model_comparisons.html#cb80-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">sapply</span>(<span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>][<span class="fu">order</span>(<span class="sc">-</span>auc)], <span class="cf">function</span>(x) {</span>
<span id="cb80-48"><a href="id_04_model_comparisons.html#cb80-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(</span>
<span id="cb80-49"><a href="id_04_model_comparisons.html#cb80-49" aria-hidden="true" tabindex="-1"></a>        x, <span class="st">&quot; (AUC = &quot;</span>,</span>
<span id="cb80-50"><a href="id_04_model_comparisons.html#cb80-50" aria-hidden="true" tabindex="-1"></a>        auc[x], <span class="st">&quot;)&quot;</span></span>
<span id="cb80-51"><a href="id_04_model_comparisons.html#cb80-51" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb80-52"><a href="id_04_model_comparisons.html#cb80-52" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb80-53"><a href="id_04_model_comparisons.html#cb80-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-54"><a href="id_04_model_comparisons.html#cb80-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb80-55"><a href="id_04_model_comparisons.html#cb80-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb80-56"><a href="id_04_model_comparisons.html#cb80-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-57"><a href="id_04_model_comparisons.html#cb80-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-58"><a href="id_04_model_comparisons.html#cb80-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-59"><a href="id_04_model_comparisons.html#cb80-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-60"><a href="id_04_model_comparisons.html#cb80-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-61"><a href="id_04_model_comparisons.html#cb80-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb80-62"><a href="id_04_model_comparisons.html#cb80-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-63"><a href="id_04_model_comparisons.html#cb80-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.34</span>, <span class="fl">0.16</span>),</span>
<span id="cb80-64"><a href="id_04_model_comparisons.html#cb80-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-65"><a href="id_04_model_comparisons.html#cb80-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb80-66"><a href="id_04_model_comparisons.html#cb80-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-67"><a href="id_04_model_comparisons.html#cb80-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-68"><a href="id_04_model_comparisons.html#cb80-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-69"><a href="id_04_model_comparisons.html#cb80-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Ranked known antigens (scaled)&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-70"><a href="id_04_model_comparisons.html#cb80-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Percent rank&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb81-1"><a href="id_04_model_comparisons.html#cb81-1" aria-hidden="true" tabindex="-1"></a>pf_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_known_antigen_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb81-2"><a href="id_04_model_comparisons.html#cb81-2" aria-hidden="true" tabindex="-1"></a>pf_unl_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_unlabeled_protein_scores.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb81-3"><a href="id_04_model_comparisons.html#cb81-3" aria-hidden="true" tabindex="-1"></a>pf_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb81-4"><a href="id_04_model_comparisons.html#cb81-4" aria-hidden="true" tabindex="-1"></a>pf_unl_scores<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-5"><a href="id_04_model_comparisons.html#cb81-5" aria-hidden="true" tabindex="-1"></a>pf_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pf_scores, pf_unl_scores)</span>
<span id="cb81-6"><a href="id_04_model_comparisons.html#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="id_04_model_comparisons.html#cb81-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-8"><a href="id_04_model_comparisons.html#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;antigen_label&quot;</span> <span class="ot">=</span> pf_all<span class="sc">$</span>label,</span>
<span id="cb81-9"><a href="id_04_model_comparisons.html#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Heterologous model&quot;</span> <span class="ot">=</span> pf_all<span class="sc">$</span>pv_single_model,</span>
<span id="cb81-10"><a href="id_04_model_comparisons.html#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Autologous model&quot;</span> <span class="ot">=</span> pf_all<span class="sc">$</span>pf_single_model,</span>
<span id="cb81-11"><a href="id_04_model_comparisons.html#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Autologous with heterologous positives model&quot;</span> <span class="ot">=</span> pf_all<span class="sc">$</span>pf_pv_pos,</span>
<span id="cb81-12"><a href="id_04_model_comparisons.html#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Combined model&quot;</span> <span class="ot">=</span> pf_all<span class="sc">$</span>pfpv_combined_model,</span>
<span id="cb81-13"><a href="id_04_model_comparisons.html#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Autologous with heterologous unlabeled model&quot;</span> <span class="ot">=</span> pf_all<span class="sc">$</span>pf_pv_unl,</span>
<span id="cb81-14"><a href="id_04_model_comparisons.html#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb81-15"><a href="id_04_model_comparisons.html#cb81-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-16"><a href="id_04_model_comparisons.html#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="id_04_model_comparisons.html#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percent rank for labeled positives</span></span>
<span id="cb81-18"><a href="id_04_model_comparisons.html#cb81-18" aria-hidden="true" tabindex="-1"></a>model_names <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-19"><a href="id_04_model_comparisons.html#cb81-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-20"><a href="id_04_model_comparisons.html#cb81-20" aria-hidden="true" tabindex="-1"></a>percent_rank <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-21"><a href="id_04_model_comparisons.html#cb81-21" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-22"><a href="id_04_model_comparisons.html#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (model <span class="cf">in</span> <span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>]) {</span>
<span id="cb81-23"><a href="id_04_model_comparisons.html#cb81-23" aria-hidden="true" tabindex="-1"></a>  data_ <span class="ot">&lt;-</span> data[<span class="fu">c</span>(<span class="st">&quot;antigen_label&quot;</span>, model)]</span>
<span id="cb81-24"><a href="id_04_model_comparisons.html#cb81-24" aria-hidden="true" tabindex="-1"></a>  percent_rank_ <span class="ot">&lt;-</span> (<span class="fu">rank</span>(data_[[model]]) <span class="sc">/</span> <span class="fu">nrow</span>(data))[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb81-25"><a href="id_04_model_comparisons.html#cb81-25" aria-hidden="true" tabindex="-1"></a>  percent_rank <span class="ot">&lt;-</span> <span class="fu">c</span>(percent_rank, percent_rank_[<span class="fu">order</span>(<span class="sc">-</span>percent_rank_)])</span>
<span id="cb81-26"><a href="id_04_model_comparisons.html#cb81-26" aria-hidden="true" tabindex="-1"></a>  data_ <span class="ot">&lt;-</span> data_[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb81-27"><a href="id_04_model_comparisons.html#cb81-27" aria-hidden="true" tabindex="-1"></a>  data_ <span class="ot">&lt;-</span> data_[<span class="fu">order</span>(<span class="sc">-</span>percent_rank_), ]</span>
<span id="cb81-28"><a href="id_04_model_comparisons.html#cb81-28" aria-hidden="true" tabindex="-1"></a>  x_ <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_) <span class="sc">/</span> <span class="fu">nrow</span>(data_)</span>
<span id="cb81-29"><a href="id_04_model_comparisons.html#cb81-29" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, x_)</span>
<span id="cb81-30"><a href="id_04_model_comparisons.html#cb81-30" aria-hidden="true" tabindex="-1"></a>  model_names <span class="ot">&lt;-</span> <span class="fu">c</span>(model_names, <span class="fu">rep</span>(model, <span class="fu">nrow</span>(data_)))</span>
<span id="cb81-31"><a href="id_04_model_comparisons.html#cb81-31" aria-hidden="true" tabindex="-1"></a>  auc <span class="ot">&lt;-</span> <span class="fu">c</span>(auc, <span class="fu">round</span>(<span class="fu">trapz</span>(<span class="fu">c</span>(<span class="dv">0</span>, x_, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, percent_rank_, <span class="dv">0</span>)), <span class="dv">2</span>))</span>
<span id="cb81-32"><a href="id_04_model_comparisons.html#cb81-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;EPR: &quot;</span>, <span class="fu">sum</span>(data_[[model]] <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">nrow</span>(data_), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb81-33"><a href="id_04_model_comparisons.html#cb81-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-34"><a href="id_04_model_comparisons.html#cb81-34" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(auc) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb81-35"><a href="id_04_model_comparisons.html#cb81-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-36"><a href="id_04_model_comparisons.html#cb81-36" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> model_names, <span class="at">x =</span> x, <span class="at">percent_rank =</span> percent_rank)</span>
<span id="cb81-37"><a href="id_04_model_comparisons.html#cb81-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-38"><a href="id_04_model_comparisons.html#cb81-38" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(res, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">percent_rank</span><span class="st">`</span>, <span class="at">group =</span> model)) <span class="sc">+</span></span>
<span id="cb81-39"><a href="id_04_model_comparisons.html#cb81-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-40"><a href="id_04_model_comparisons.html#cb81-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-41"><a href="id_04_model_comparisons.html#cb81-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> model),</span>
<span id="cb81-42"><a href="id_04_model_comparisons.html#cb81-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.1</span>,</span>
<span id="cb81-43"><a href="id_04_model_comparisons.html#cb81-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb81-44"><a href="id_04_model_comparisons.html#cb81-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb81-45"><a href="id_04_model_comparisons.html#cb81-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_jco</span>(</span>
<span id="cb81-46"><a href="id_04_model_comparisons.html#cb81-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>][<span class="fu">order</span>(<span class="sc">-</span>auc)],</span>
<span id="cb81-47"><a href="id_04_model_comparisons.html#cb81-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">sapply</span>(<span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>][<span class="fu">order</span>(<span class="sc">-</span>auc)], <span class="cf">function</span>(x) {</span>
<span id="cb81-48"><a href="id_04_model_comparisons.html#cb81-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(</span>
<span id="cb81-49"><a href="id_04_model_comparisons.html#cb81-49" aria-hidden="true" tabindex="-1"></a>        x, <span class="st">&quot; (AUC = &quot;</span>,</span>
<span id="cb81-50"><a href="id_04_model_comparisons.html#cb81-50" aria-hidden="true" tabindex="-1"></a>        auc[x], <span class="st">&quot;)&quot;</span></span>
<span id="cb81-51"><a href="id_04_model_comparisons.html#cb81-51" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb81-52"><a href="id_04_model_comparisons.html#cb81-52" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb81-53"><a href="id_04_model_comparisons.html#cb81-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb81-54"><a href="id_04_model_comparisons.html#cb81-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb81-55"><a href="id_04_model_comparisons.html#cb81-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb81-56"><a href="id_04_model_comparisons.html#cb81-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-57"><a href="id_04_model_comparisons.html#cb81-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-58"><a href="id_04_model_comparisons.html#cb81-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb81-59"><a href="id_04_model_comparisons.html#cb81-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb81-60"><a href="id_04_model_comparisons.html#cb81-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb81-61"><a href="id_04_model_comparisons.html#cb81-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb81-62"><a href="id_04_model_comparisons.html#cb81-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb81-63"><a href="id_04_model_comparisons.html#cb81-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.34</span>, <span class="fl">0.16</span>),</span>
<span id="cb81-64"><a href="id_04_model_comparisons.html#cb81-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-65"><a href="id_04_model_comparisons.html#cb81-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb81-66"><a href="id_04_model_comparisons.html#cb81-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb81-67"><a href="id_04_model_comparisons.html#cb81-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-68"><a href="id_04_model_comparisons.html#cb81-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb81-69"><a href="id_04_model_comparisons.html#cb81-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Ranked known antigens (scaled)&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-70"><a href="id_04_model_comparisons.html#cb81-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Percent rank&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb82-1"><a href="id_04_model_comparisons.html#cb82-1" aria-hidden="true" tabindex="-1"></a>p_combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb82-2"><a href="id_04_model_comparisons.html#cb82-2" aria-hidden="true" tabindex="-1"></a>p_combined</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb83-1"><a href="id_04_model_comparisons.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">&quot;./figures/Supplementary Fig 6.png&quot;</span>, <span class="at">width =</span> <span class="dv">7600</span>, <span class="at">height =</span> <span class="dv">3500</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb83-2"><a href="id_04_model_comparisons.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_combined)</span>
<span id="cb83-3"><a href="id_04_model_comparisons.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb83-4"><a href="id_04_model_comparisons.html#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="id_04_model_comparisons.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;../supplementary_figures/Supplementary Fig 6.pdf&quot;</span>, <span class="at">width =</span> <span class="fl">15.2</span>, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb83-6"><a href="id_04_model_comparisons.html#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_combined)</span>
<span id="cb83-7"><a href="id_04_model_comparisons.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%206.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="score-and-species-association" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Score and species association<a href="id_04_model_comparisons.html#score-and-species-association" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb84-1"><a href="id_04_model_comparisons.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb84-2"><a href="id_04_model_comparisons.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlist)</span>
<span id="cb84-3"><a href="id_04_model_comparisons.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb84-4"><a href="id_04_model_comparisons.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb85-1"><a href="id_04_model_comparisons.html#cb85-1" aria-hidden="true" tabindex="-1"></a>scientific <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb85-2"><a href="id_04_model_comparisons.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;0&quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;e&quot;</span>, <span class="st">&quot; * 10^&quot;</span>, <span class="fu">scientific_format</span>(<span class="at">digits =</span> <span class="dv">3</span>)(x)))</span>
<span id="cb85-3"><a href="id_04_model_comparisons.html#cb85-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-4"><a href="id_04_model_comparisons.html#cb85-4" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb85-5"><a href="id_04_model_comparisons.html#cb85-5" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb85-6"><a href="id_04_model_comparisons.html#cb85-6" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb85-7"><a href="id_04_model_comparisons.html#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined</span></span>
<span id="cb85-8"><a href="id_04_model_comparisons.html#cb85-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_5_pfpv_purf_oob_predictions.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-9"><a href="id_04_model_comparisons.html#cb85-9" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-10"><a href="id_04_model_comparisons.html#cb85-10" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> data<span class="sc">$</span>species[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-11"><a href="id_04_model_comparisons.html#cb85-11" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(pred, species)</span>
<span id="cb85-12"><a href="id_04_model_comparisons.html#cb85-12" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-13"><a href="id_04_model_comparisons.html#cb85-13" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-14"><a href="id_04_model_comparisons.html#cb85-14" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-15"><a href="id_04_model_comparisons.html#cb85-15" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-16"><a href="id_04_model_comparisons.html#cb85-16" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-17"><a href="id_04_model_comparisons.html#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="co"># P. vivax &amp; P. falciparum single models</span></span>
<span id="cb85-18"><a href="id_04_model_comparisons.html#cb85-18" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_single_pv_single_scores.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-19"><a href="id_04_model_comparisons.html#cb85-19" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_single_pv_single_cross_predictions.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-20"><a href="id_04_model_comparisons.html#cb85-20" aria-hidden="true" tabindex="-1"></a>pred_1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data_1<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>[data_1<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-21"><a href="id_04_model_comparisons.html#cb85-21" aria-hidden="true" tabindex="-1"></a>species_1 <span class="ot">&lt;-</span> data_1<span class="sc">$</span>species[data_1<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-22"><a href="id_04_model_comparisons.html#cb85-22" aria-hidden="true" tabindex="-1"></a>pred_2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data_2<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>[data_2<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-23"><a href="id_04_model_comparisons.html#cb85-23" aria-hidden="true" tabindex="-1"></a>species_2 <span class="ot">&lt;-</span> data_2<span class="sc">$</span>species[data_2<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-24"><a href="id_04_model_comparisons.html#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="do">## P. vivax</span></span>
<span id="cb85-25"><a href="id_04_model_comparisons.html#cb85-25" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb85-26"><a href="id_04_model_comparisons.html#cb85-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(pred_1[species_1 <span class="sc">==</span> <span class="st">&quot;pv&quot;</span>], pred_2[species_2 <span class="sc">==</span> <span class="st">&quot;pf&quot;</span>]),</span>
<span id="cb85-27"><a href="id_04_model_comparisons.html#cb85-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;pv&quot;</span>, <span class="fu">length</span>(pred_1[species_1 <span class="sc">==</span> <span class="st">&quot;pv&quot;</span>])), <span class="fu">rep</span>(<span class="st">&quot;pf&quot;</span>, <span class="fu">length</span>(pred_2[species_2 <span class="sc">==</span> <span class="st">&quot;pf&quot;</span>])))</span>
<span id="cb85-28"><a href="id_04_model_comparisons.html#cb85-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-29"><a href="id_04_model_comparisons.html#cb85-29" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-30"><a href="id_04_model_comparisons.html#cb85-30" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-31"><a href="id_04_model_comparisons.html#cb85-31" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-32"><a href="id_04_model_comparisons.html#cb85-32" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-33"><a href="id_04_model_comparisons.html#cb85-33" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-34"><a href="id_04_model_comparisons.html#cb85-34" aria-hidden="true" tabindex="-1"></a><span class="do">## P. falciparum</span></span>
<span id="cb85-35"><a href="id_04_model_comparisons.html#cb85-35" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb85-36"><a href="id_04_model_comparisons.html#cb85-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(pred_1[species_1 <span class="sc">==</span> <span class="st">&quot;pf&quot;</span>], pred_2[species_2 <span class="sc">==</span> <span class="st">&quot;pv&quot;</span>]),</span>
<span id="cb85-37"><a href="id_04_model_comparisons.html#cb85-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;pf&quot;</span>, <span class="fu">length</span>(pred_1[species_1 <span class="sc">==</span> <span class="st">&quot;pf&quot;</span>])), <span class="fu">rep</span>(<span class="st">&quot;pv&quot;</span>, <span class="fu">length</span>(pred_2[species_2 <span class="sc">==</span> <span class="st">&quot;pv&quot;</span>])))</span>
<span id="cb85-38"><a href="id_04_model_comparisons.html#cb85-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-39"><a href="id_04_model_comparisons.html#cb85-39" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-40"><a href="id_04_model_comparisons.html#cb85-40" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-41"><a href="id_04_model_comparisons.html#cb85-41" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-42"><a href="id_04_model_comparisons.html#cb85-42" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-43"><a href="id_04_model_comparisons.html#cb85-43" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-44"><a href="id_04_model_comparisons.html#cb85-44" aria-hidden="true" tabindex="-1"></a><span class="co"># P. vivax with heterologous positives</span></span>
<span id="cb85-45"><a href="id_04_model_comparisons.html#cb85-45" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pv_pf_pos_scores.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-46"><a href="id_04_model_comparisons.html#cb85-46" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">OOB scores</span><span class="st">`</span>[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-47"><a href="id_04_model_comparisons.html#cb85-47" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> data<span class="sc">$</span>species[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-48"><a href="id_04_model_comparisons.html#cb85-48" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(pred, species)</span>
<span id="cb85-49"><a href="id_04_model_comparisons.html#cb85-49" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-50"><a href="id_04_model_comparisons.html#cb85-50" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-51"><a href="id_04_model_comparisons.html#cb85-51" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-52"><a href="id_04_model_comparisons.html#cb85-52" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-53"><a href="id_04_model_comparisons.html#cb85-53" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-54"><a href="id_04_model_comparisons.html#cb85-54" aria-hidden="true" tabindex="-1"></a><span class="co"># P. falciparum with heterologous positives</span></span>
<span id="cb85-55"><a href="id_04_model_comparisons.html#cb85-55" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_pv_pos_scores.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-56"><a href="id_04_model_comparisons.html#cb85-56" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">OOB scores</span><span class="st">`</span>[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-57"><a href="id_04_model_comparisons.html#cb85-57" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> data<span class="sc">$</span>species[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-58"><a href="id_04_model_comparisons.html#cb85-58" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(pred, species)</span>
<span id="cb85-59"><a href="id_04_model_comparisons.html#cb85-59" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-60"><a href="id_04_model_comparisons.html#cb85-60" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-61"><a href="id_04_model_comparisons.html#cb85-61" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-62"><a href="id_04_model_comparisons.html#cb85-62" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-63"><a href="id_04_model_comparisons.html#cb85-63" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-64"><a href="id_04_model_comparisons.html#cb85-64" aria-hidden="true" tabindex="-1"></a><span class="co"># P. vivax with heterologous unlabeled</span></span>
<span id="cb85-65"><a href="id_04_model_comparisons.html#cb85-65" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pv_pf_unl_scores.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-66"><a href="id_04_model_comparisons.html#cb85-66" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">OOB scores</span><span class="st">`</span>[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-67"><a href="id_04_model_comparisons.html#cb85-67" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> data<span class="sc">$</span>species[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-68"><a href="id_04_model_comparisons.html#cb85-68" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(pred, species)</span>
<span id="cb85-69"><a href="id_04_model_comparisons.html#cb85-69" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-70"><a href="id_04_model_comparisons.html#cb85-70" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-71"><a href="id_04_model_comparisons.html#cb85-71" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-72"><a href="id_04_model_comparisons.html#cb85-72" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-73"><a href="id_04_model_comparisons.html#cb85-73" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-74"><a href="id_04_model_comparisons.html#cb85-74" aria-hidden="true" tabindex="-1"></a><span class="co"># P. falciparum with heterologous unlabeled</span></span>
<span id="cb85-75"><a href="id_04_model_comparisons.html#cb85-75" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_pv_unl_scores.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb85-76"><a href="id_04_model_comparisons.html#cb85-76" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">OOB scores</span><span class="st">`</span>[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>], <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="st">&quot;pos&quot;</span> <span class="cf">else</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb85-77"><a href="id_04_model_comparisons.html#cb85-77" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> data<span class="sc">$</span>species[data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb85-78"><a href="id_04_model_comparisons.html#cb85-78" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">table</span>(pred, species)</span>
<span id="cb85-79"><a href="id_04_model_comparisons.html#cb85-79" aria-hidden="true" tabindex="-1"></a>Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-80"><a href="id_04_model_comparisons.html#cb85-80" aria-hidden="true" tabindex="-1"></a>cramerV <span class="ot">&lt;-</span> <span class="fu">cramerV</span>(M, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-81"><a href="id_04_model_comparisons.html#cb85-81" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">list.append</span>(contingency_table, M)</span>
<span id="cb85-82"><a href="id_04_model_comparisons.html#cb85-82" aria-hidden="true" tabindex="-1"></a>chisq_pval <span class="ot">&lt;-</span> <span class="fu">c</span>(chisq_pval, Xsq<span class="sc">$</span>p.value)</span>
<span id="cb85-83"><a href="id_04_model_comparisons.html#cb85-83" aria-hidden="true" tabindex="-1"></a>cramer_res <span class="ot">&lt;-</span> <span class="fu">list.append</span>(cramer_res, <span class="fu">sprintf</span>(<span class="st">&quot;%0.2f&quot;</span>, cramerV))</span>
<span id="cb85-84"><a href="id_04_model_comparisons.html#cb85-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results</span></span>
<span id="cb85-85"><a href="id_04_model_comparisons.html#cb85-85" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb85-86"><a href="id_04_model_comparisons.html#cb85-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb85-87"><a href="id_04_model_comparisons.html#cb85-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Combined&quot;</span>, <span class="st">&quot;P. vivax&quot;</span>, <span class="st">&quot;P. falciparum&quot;</span>,</span>
<span id="cb85-88"><a href="id_04_model_comparisons.html#cb85-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;P. vivax with heterologous positives&quot;</span>,</span>
<span id="cb85-89"><a href="id_04_model_comparisons.html#cb85-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;P. falciparum with heterologous positives&quot;</span>,</span>
<span id="cb85-90"><a href="id_04_model_comparisons.html#cb85-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;P. vivax with heterologous unlabeled&quot;</span>,</span>
<span id="cb85-91"><a href="id_04_model_comparisons.html#cb85-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;P. falciparum with heterologous unlabeled&quot;</span></span>
<span id="cb85-92"><a href="id_04_model_comparisons.html#cb85-92" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb85-93"><a href="id_04_model_comparisons.html#cb85-93" aria-hidden="true" tabindex="-1"></a>  chisq_pval, <span class="fu">do.call</span>(rbind, cramer_res)</span>
<span id="cb85-94"><a href="id_04_model_comparisons.html#cb85-94" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb85-95"><a href="id_04_model_comparisons.html#cb85-95" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PURF model&quot;</span>, <span class="st">&quot;Chi-squared test p-value&quot;</span>, <span class="st">&quot;Cramer&#39;s V&quot;</span>, <span class="st">&quot;Lower CI&quot;</span>, <span class="st">&quot;Upper CI&quot;</span>)</span>
<span id="cb85-96"><a href="id_04_model_comparisons.html#cb85-96" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span><span class="st">`</span><span class="at">Chi-squared test p-value</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">Chi-squared test p-value</span><span class="st">`</span>), scientific)</span>
<span id="cb85-97"><a href="id_04_model_comparisons.html#cb85-97" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(contingency_table) <span class="ot">&lt;-</span> df<span class="sc">$</span><span class="st">`</span><span class="at">PURF model</span><span class="st">`</span></span>
<span id="cb85-98"><a href="id_04_model_comparisons.html#cb85-98" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(contingency_table, df, <span class="at">file =</span> <span class="st">&quot;./rdata/score_species_association.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb86-1"><a href="id_04_model_comparisons.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./rdata/score_species_association.RData&quot;</span>)</span>
<span id="cb86-2"><a href="id_04_model_comparisons.html#cb86-2" aria-hidden="true" tabindex="-1"></a>contingency_table</span></code></pre></div>
<pre><code>## $Combined
##      species
## pred    pf   pv
##   neg 2719 3814
##   pos 2622 2639
## 
## $`P. falciparum`
##      
##         pf   pv
##   neg 2897 3091
##   pos 2444 3362
## 
## $`P. vivax`
##      
##         pf   pv
##   neg 2451 3618
##   pos 2890 2835
## 
## $`P. falciparum with heterologous positives`
##      species
## pred    pf   pv
##   neg 2932   63
##   pos 2409 6390
## 
## $`P. vivax with heterologous positives`
##      species
## pred    pf   pv
##   neg    0 3695
##   pos 5341 2758
## 
## $`P. falciparum with heterologous unlabeled`
##      species
## pred    pf   pv
##   neg  108 6314
##   pos 5233  139
## 
## $`P. vivax with heterologous unlabeled`
##      species
## pred    pf   pv
##   neg 5133 1055
##   pos  208 5398</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb88-1"><a href="id_04_model_comparisons.html#cb88-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="id_04_model_comparisons.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8f056c28eb67214a9e1d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8f056c28eb67214a9e1d">{"x":{"filter":"none","vertical":false,"data":[["Combined","P. falciparum","P. vivax","P. falciparum with heterologous positives","P. vivax with heterologous positives","P. falciparum with heterologous unlabeled","P. vivax with heterologous unlabeled"],["4.95 * 10^-19","7.08 * 10^-12","3.52 * 10^-28","0","0","0","0"],["0.08","0.06","0.10","0.62","0.61","0.96","0.80"],["0.06","0.05","0.08","0.61","0.60","0.95","0.78"],["0.10","0.08","0.12","0.63","0.62","0.96","0.80"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>PURF model<\/th>\n      <th>Chi-squared test p-value<\/th>\n      <th>Cramer's V<\/th>\n      <th>Lower CI<\/th>\n      <th>Upper CI<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="tree-depth-analysis" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Tree depth analysis<a href="id_04_model_comparisons.html#tree-depth-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="analysis-3" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Analysis<a href="id_04_model_comparisons.html#analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In Python: </strong></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb89-1"><a href="id_04_model_comparisons.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb89-2"><a href="id_04_model_comparisons.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">use_condaenv</span>(<span class="st">&quot;/Users/renee/Library/r-miniconda/envs/purf/bin/python&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb90-1"><a href="id_04_model_comparisons.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb90-2"><a href="id_04_model_comparisons.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb90-3"><a href="id_04_model_comparisons.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb90-4"><a href="id_04_model_comparisons.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> purf.pu_ensemble <span class="im">import</span> PURandomForestClassifier</span>
<span id="cb90-5"><a href="id_04_model_comparisons.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> session_info</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb91-1"><a href="id_04_model_comparisons.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pf_0.5_purf_tree_filtering.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-2"><a href="id_04_model_comparisons.html#cb91-2" aria-hidden="true" tabindex="-1"></a>    pf_single_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-3"><a href="id_04_model_comparisons.html#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="id_04_model_comparisons.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pv_0.5_purf_tree_filtering.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-5"><a href="id_04_model_comparisons.html#cb91-5" aria-hidden="true" tabindex="-1"></a>    pv_single_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-6"><a href="id_04_model_comparisons.html#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="id_04_model_comparisons.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pfpv_0.5_purf_tree_filtering.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-8"><a href="id_04_model_comparisons.html#cb91-8" aria-hidden="true" tabindex="-1"></a>    pfpv_combined_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-9"><a href="id_04_model_comparisons.html#cb91-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-10"><a href="id_04_model_comparisons.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pf_pv_pos_purf.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-11"><a href="id_04_model_comparisons.html#cb91-11" aria-hidden="true" tabindex="-1"></a>    pf_pv_pos_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-12"><a href="id_04_model_comparisons.html#cb91-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-13"><a href="id_04_model_comparisons.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pf_pv_unl_purf.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-14"><a href="id_04_model_comparisons.html#cb91-14" aria-hidden="true" tabindex="-1"></a>    pf_pv_unl_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-15"><a href="id_04_model_comparisons.html#cb91-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-16"><a href="id_04_model_comparisons.html#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pv_pf_pos_purf.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-17"><a href="id_04_model_comparisons.html#cb91-17" aria-hidden="true" tabindex="-1"></a>    pv_pf_pos_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-18"><a href="id_04_model_comparisons.html#cb91-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-19"><a href="id_04_model_comparisons.html#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./pickle_data/pv_pf_unl_purf.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> infile:</span>
<span id="cb91-20"><a href="id_04_model_comparisons.html#cb91-20" aria-hidden="true" tabindex="-1"></a>    pv_pf_unl_model <span class="op">=</span> pickle.load(infile)</span>
<span id="cb91-21"><a href="id_04_model_comparisons.html#cb91-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-22"><a href="id_04_model_comparisons.html#cb91-22" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> pd.DataFrame({<span class="st">&#39;pf_single_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pf_single_model[<span class="st">&#39;model&#39;</span>].estimators_],</span>
<span id="cb91-23"><a href="id_04_model_comparisons.html#cb91-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pv_single_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pv_single_model[<span class="st">&#39;model&#39;</span>].estimators_],</span>
<span id="cb91-24"><a href="id_04_model_comparisons.html#cb91-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pfpv_combined_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pfpv_combined_model[<span class="st">&#39;model&#39;</span>].estimators_],</span>
<span id="cb91-25"><a href="id_04_model_comparisons.html#cb91-25" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pf_pv_pos_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pf_pv_pos_model[<span class="st">&#39;model&#39;</span>].estimators_],</span>
<span id="cb91-26"><a href="id_04_model_comparisons.html#cb91-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pf_pv_unl_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pf_pv_unl_model[<span class="st">&#39;model&#39;</span>].estimators_],</span>
<span id="cb91-27"><a href="id_04_model_comparisons.html#cb91-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pv_pf_pos_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pv_pf_pos_model[<span class="st">&#39;model&#39;</span>].estimators_],</span>
<span id="cb91-28"><a href="id_04_model_comparisons.html#cb91-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pv_pf_unl_model&#39;</span>: [tree.get_depth() <span class="cf">for</span> tree <span class="kw">in</span> pv_pf_unl_model[<span class="st">&#39;model&#39;</span>].estimators_]})</span>
<span id="cb91-29"><a href="id_04_model_comparisons.html#cb91-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-30"><a href="id_04_model_comparisons.html#cb91-30" aria-hidden="true" tabindex="-1"></a>res.to_csv(<span class="st">&#39;./other_data/tree_depths.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p><strong>In R</strong></p>
</div>
<div id="plotting-2" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Plotting<a href="id_04_model_comparisons.html#plotting-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb92-1"><a href="id_04_model_comparisons.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb92-2"><a href="id_04_model_comparisons.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb93-1"><a href="id_04_model_comparisons.html#cb93-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/tree_depths.csv&quot;</span>)</span>
<span id="cb93-2"><a href="id_04_model_comparisons.html#cb93-2" aria-hidden="true" tabindex="-1"></a>proportion_positives <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span> <span class="sc">/</span> <span class="dv">5393</span>, <span class="dv">90</span> <span class="sc">/</span> <span class="dv">5431</span>, <span class="dv">52</span> <span class="sc">/</span> <span class="dv">11846</span>, <span class="dv">38</span> <span class="sc">/</span> <span class="dv">6491</span>, <span class="dv">90</span> <span class="sc">/</span> <span class="dv">6543</span>, <span class="dv">38</span> <span class="sc">/</span> <span class="dv">11832</span>, <span class="dv">90</span> <span class="sc">/</span> <span class="dv">11884</span>)</span>
<span id="cb93-3"><a href="id_04_model_comparisons.html#cb93-3" aria-hidden="true" tabindex="-1"></a>mean_tree_depth <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb93-4"><a href="id_04_model_comparisons.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data<span class="sc">$</span>pf_single_model), <span class="fu">mean</span>(data<span class="sc">$</span>pf_pv_pos_model), <span class="fu">mean</span>(data<span class="sc">$</span>pf_pv_unl_model),</span>
<span id="cb93-5"><a href="id_04_model_comparisons.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data<span class="sc">$</span>pv_single_model), <span class="fu">mean</span>(data<span class="sc">$</span>pv_pf_pos_model), <span class="fu">mean</span>(data<span class="sc">$</span>pv_pf_unl_model),</span>
<span id="cb93-6"><a href="id_04_model_comparisons.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data<span class="sc">$</span>pfpv_combined_model)</span>
<span id="cb93-7"><a href="id_04_model_comparisons.html#cb93-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-8"><a href="id_04_model_comparisons.html#cb93-8" aria-hidden="true" tabindex="-1"></a>sd_tree_depth <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb93-9"><a href="id_04_model_comparisons.html#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(data<span class="sc">$</span>pf_single_model), <span class="fu">sd</span>(data<span class="sc">$</span>pf_pv_pos_model), <span class="fu">sd</span>(data<span class="sc">$</span>pf_pv_unl_model),</span>
<span id="cb93-10"><a href="id_04_model_comparisons.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(data<span class="sc">$</span>pv_single_model), <span class="fu">sd</span>(data<span class="sc">$</span>pv_pf_pos_model), <span class="fu">sd</span>(data<span class="sc">$</span>pv_pf_unl_model),</span>
<span id="cb93-11"><a href="id_04_model_comparisons.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(data<span class="sc">$</span>pfpv_combined_model)</span>
<span id="cb93-12"><a href="id_04_model_comparisons.html#cb93-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-13"><a href="id_04_model_comparisons.html#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="id_04_model_comparisons.html#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-15"><a href="id_04_model_comparisons.html#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-16"><a href="id_04_model_comparisons.html#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;No transformation</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-17"><a href="id_04_model_comparisons.html#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="do">## No transformation</span></span>
<span id="cb93-18"><a href="id_04_model_comparisons.html#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-19"><a href="id_04_model_comparisons.html#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-20"><a href="id_04_model_comparisons.html#cb93-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives,</span>
<span id="cb93-21"><a href="id_04_model_comparisons.html#cb93-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-22"><a href="id_04_model_comparisons.html#cb93-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion_positives =</span> proportion_positives,</span>
<span id="cb93-23"><a href="id_04_model_comparisons.html#cb93-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_tree_depth =</span> mean_tree_depth</span>
<span id="cb93-24"><a href="id_04_model_comparisons.html#cb93-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-25"><a href="id_04_model_comparisons.html#cb93-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-26"><a href="id_04_model_comparisons.html#cb93-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb93-27"><a href="id_04_model_comparisons.html#cb93-27" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-28"><a href="id_04_model_comparisons.html#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb93-29"><a href="id_04_model_comparisons.html#cb93-29" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = mean_tree_depth ~ proportion_positives, data = data.frame(proportion_positives = proportion_positives, </span></span>
<span id="cb93-30"><a href="id_04_model_comparisons.html#cb93-30" aria-hidden="true" tabindex="-1"></a><span class="do">##     mean_tree_depth = mean_tree_depth))</span></span>
<span id="cb93-31"><a href="id_04_model_comparisons.html#cb93-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-32"><a href="id_04_model_comparisons.html#cb93-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb93-33"><a href="id_04_model_comparisons.html#cb93-33" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2        3        4        5        6        7 </span></span>
<span id="cb93-34"><a href="id_04_model_comparisons.html#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.12948 -0.97473 -1.25954  0.10225  0.04435 -1.13048  3.34764 </span></span>
<span id="cb93-35"><a href="id_04_model_comparisons.html#cb93-35" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-36"><a href="id_04_model_comparisons.html#cb93-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb93-37"><a href="id_04_model_comparisons.html#cb93-37" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb93-38"><a href="id_04_model_comparisons.html#cb93-38" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)             3.269      1.411   2.317   0.0683 .</span></span>
<span id="cb93-39"><a href="id_04_model_comparisons.html#cb93-39" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion_positives  366.882    143.355   2.559   0.0507 .</span></span>
<span id="cb93-40"><a href="id_04_model_comparisons.html#cb93-40" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb93-41"><a href="id_04_model_comparisons.html#cb93-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-42"><a href="id_04_model_comparisons.html#cb93-42" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-43"><a href="id_04_model_comparisons.html#cb93-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 1.735 on 5 degrees of freedom</span></span>
<span id="cb93-44"><a href="id_04_model_comparisons.html#cb93-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5671, Adjusted R-squared:  0.4805 </span></span>
<span id="cb93-45"><a href="id_04_model_comparisons.html#cb93-45" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic:  6.55 on 1 and 5 DF,  p-value: 0.05069</span></span>
<span id="cb93-46"><a href="id_04_model_comparisons.html#cb93-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-47"><a href="id_04_model_comparisons.html#cb93-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-48"><a href="id_04_model_comparisons.html#cb93-48" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-49"><a href="id_04_model_comparisons.html#cb93-49" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Log transform for tree depth</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-50"><a href="id_04_model_comparisons.html#cb93-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Log transform for tree depth</span></span>
<span id="cb93-51"><a href="id_04_model_comparisons.html#cb93-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-52"><a href="id_04_model_comparisons.html#cb93-52" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-53"><a href="id_04_model_comparisons.html#cb93-53" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives,</span>
<span id="cb93-54"><a href="id_04_model_comparisons.html#cb93-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-55"><a href="id_04_model_comparisons.html#cb93-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion_positives =</span> proportion_positives,</span>
<span id="cb93-56"><a href="id_04_model_comparisons.html#cb93-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_tree_depth =</span> <span class="fu">log2</span>(mean_tree_depth)</span>
<span id="cb93-57"><a href="id_04_model_comparisons.html#cb93-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-58"><a href="id_04_model_comparisons.html#cb93-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-59"><a href="id_04_model_comparisons.html#cb93-59" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb93-60"><a href="id_04_model_comparisons.html#cb93-60" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-61"><a href="id_04_model_comparisons.html#cb93-61" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb93-62"><a href="id_04_model_comparisons.html#cb93-62" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = mean_tree_depth ~ proportion_positives, data = data.frame(proportion_positives = proportion_positives, </span></span>
<span id="cb93-63"><a href="id_04_model_comparisons.html#cb93-63" aria-hidden="true" tabindex="-1"></a><span class="do">##     mean_tree_depth = log2(mean_tree_depth)))</span></span>
<span id="cb93-64"><a href="id_04_model_comparisons.html#cb93-64" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-65"><a href="id_04_model_comparisons.html#cb93-65" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb93-66"><a href="id_04_model_comparisons.html#cb93-66" aria-hidden="true" tabindex="-1"></a><span class="do">##         1         2         3         4         5         6         7 </span></span>
<span id="cb93-67"><a href="id_04_model_comparisons.html#cb93-67" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.058792 -0.267279 -0.329568  0.140857 -0.004416 -0.344751  0.746365 </span></span>
<span id="cb93-68"><a href="id_04_model_comparisons.html#cb93-68" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-69"><a href="id_04_model_comparisons.html#cb93-69" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb93-70"><a href="id_04_model_comparisons.html#cb93-70" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb93-71"><a href="id_04_model_comparisons.html#cb93-71" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)             1.772      0.341   5.197  0.00348 **</span></span>
<span id="cb93-72"><a href="id_04_model_comparisons.html#cb93-72" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion_positives   94.203     34.650   2.719  0.04184 * </span></span>
<span id="cb93-73"><a href="id_04_model_comparisons.html#cb93-73" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb93-74"><a href="id_04_model_comparisons.html#cb93-74" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-75"><a href="id_04_model_comparisons.html#cb93-75" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-76"><a href="id_04_model_comparisons.html#cb93-76" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 0.4194 on 5 degrees of freedom</span></span>
<span id="cb93-77"><a href="id_04_model_comparisons.html#cb93-77" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5965, Adjusted R-squared:  0.5158 </span></span>
<span id="cb93-78"><a href="id_04_model_comparisons.html#cb93-78" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 7.391 on 1 and 5 DF,  p-value: 0.04184</span></span>
<span id="cb93-79"><a href="id_04_model_comparisons.html#cb93-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-80"><a href="id_04_model_comparisons.html#cb93-80" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-81"><a href="id_04_model_comparisons.html#cb93-81" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-82"><a href="id_04_model_comparisons.html#cb93-82" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Logit transform for proportion positives</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-83"><a href="id_04_model_comparisons.html#cb93-83" aria-hidden="true" tabindex="-1"></a><span class="do">## Logit transform for proportion positives</span></span>
<span id="cb93-84"><a href="id_04_model_comparisons.html#cb93-84" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-85"><a href="id_04_model_comparisons.html#cb93-85" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-86"><a href="id_04_model_comparisons.html#cb93-86" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives,</span>
<span id="cb93-87"><a href="id_04_model_comparisons.html#cb93-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-88"><a href="id_04_model_comparisons.html#cb93-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion_positives =</span> <span class="fu">logit</span>(proportion_positives),</span>
<span id="cb93-89"><a href="id_04_model_comparisons.html#cb93-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_tree_depth =</span> mean_tree_depth</span>
<span id="cb93-90"><a href="id_04_model_comparisons.html#cb93-90" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-91"><a href="id_04_model_comparisons.html#cb93-91" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-92"><a href="id_04_model_comparisons.html#cb93-92" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb93-93"><a href="id_04_model_comparisons.html#cb93-93" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-94"><a href="id_04_model_comparisons.html#cb93-94" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb93-95"><a href="id_04_model_comparisons.html#cb93-95" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = mean_tree_depth ~ proportion_positives, data = data.frame(proportion_positives = logit(proportion_positives), </span></span>
<span id="cb93-96"><a href="id_04_model_comparisons.html#cb93-96" aria-hidden="true" tabindex="-1"></a><span class="do">##     mean_tree_depth = mean_tree_depth))</span></span>
<span id="cb93-97"><a href="id_04_model_comparisons.html#cb93-97" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-98"><a href="id_04_model_comparisons.html#cb93-98" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb93-99"><a href="id_04_model_comparisons.html#cb93-99" aria-hidden="true" tabindex="-1"></a><span class="do">##       1       2       3       4       5       6       7 </span></span>
<span id="cb93-100"><a href="id_04_model_comparisons.html#cb93-100" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.6182 -0.7549 -1.0271 -0.0954 -0.1369 -0.2818  2.9143 </span></span>
<span id="cb93-101"><a href="id_04_model_comparisons.html#cb93-101" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-102"><a href="id_04_model_comparisons.html#cb93-102" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb93-103"><a href="id_04_model_comparisons.html#cb93-103" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb93-104"><a href="id_04_model_comparisons.html#cb93-104" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)           22.7794     4.8653   4.682  0.00542 **</span></span>
<span id="cb93-105"><a href="id_04_model_comparisons.html#cb93-105" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion_positives   3.3428     0.9906   3.375  0.01979 * </span></span>
<span id="cb93-106"><a href="id_04_model_comparisons.html#cb93-106" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb93-107"><a href="id_04_model_comparisons.html#cb93-107" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-108"><a href="id_04_model_comparisons.html#cb93-108" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-109"><a href="id_04_model_comparisons.html#cb93-109" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 1.457 on 5 degrees of freedom</span></span>
<span id="cb93-110"><a href="id_04_model_comparisons.html#cb93-110" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6949, Adjusted R-squared:  0.6339 </span></span>
<span id="cb93-111"><a href="id_04_model_comparisons.html#cb93-111" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 11.39 on 1 and 5 DF,  p-value: 0.01979</span></span>
<span id="cb93-112"><a href="id_04_model_comparisons.html#cb93-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-113"><a href="id_04_model_comparisons.html#cb93-113" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-114"><a href="id_04_model_comparisons.html#cb93-114" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-115"><a href="id_04_model_comparisons.html#cb93-115" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Arc-sine transform for proportion positives</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-116"><a href="id_04_model_comparisons.html#cb93-116" aria-hidden="true" tabindex="-1"></a><span class="do">## Arc-sine transform for proportion positives</span></span>
<span id="cb93-117"><a href="id_04_model_comparisons.html#cb93-117" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-118"><a href="id_04_model_comparisons.html#cb93-118" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-119"><a href="id_04_model_comparisons.html#cb93-119" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives,</span>
<span id="cb93-120"><a href="id_04_model_comparisons.html#cb93-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-121"><a href="id_04_model_comparisons.html#cb93-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion_positives =</span> <span class="fu">asin</span>(<span class="fu">sqrt</span>(proportion_positives)),</span>
<span id="cb93-122"><a href="id_04_model_comparisons.html#cb93-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_tree_depth =</span> mean_tree_depth</span>
<span id="cb93-123"><a href="id_04_model_comparisons.html#cb93-123" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-124"><a href="id_04_model_comparisons.html#cb93-124" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-125"><a href="id_04_model_comparisons.html#cb93-125" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb93-126"><a href="id_04_model_comparisons.html#cb93-126" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-127"><a href="id_04_model_comparisons.html#cb93-127" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb93-128"><a href="id_04_model_comparisons.html#cb93-128" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = mean_tree_depth ~ proportion_positives, data = data.frame(proportion_positives = asin(sqrt(proportion_positives)), </span></span>
<span id="cb93-129"><a href="id_04_model_comparisons.html#cb93-129" aria-hidden="true" tabindex="-1"></a><span class="do">##     mean_tree_depth = mean_tree_depth))</span></span>
<span id="cb93-130"><a href="id_04_model_comparisons.html#cb93-130" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-131"><a href="id_04_model_comparisons.html#cb93-131" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb93-132"><a href="id_04_model_comparisons.html#cb93-132" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2        3        4        5        6        7 </span></span>
<span id="cb93-133"><a href="id_04_model_comparisons.html#cb93-133" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.37586 -0.90400 -1.11266  0.04187 -0.08305 -0.72069  3.15439 </span></span>
<span id="cb93-134"><a href="id_04_model_comparisons.html#cb93-134" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-135"><a href="id_04_model_comparisons.html#cb93-135" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb93-136"><a href="id_04_model_comparisons.html#cb93-136" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb93-137"><a href="id_04_model_comparisons.html#cb93-137" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)          -0.06706    2.29355  -0.029   0.9778  </span></span>
<span id="cb93-138"><a href="id_04_model_comparisons.html#cb93-138" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion_positives 72.39644   24.52407   2.952   0.0318 *</span></span>
<span id="cb93-139"><a href="id_04_model_comparisons.html#cb93-139" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb93-140"><a href="id_04_model_comparisons.html#cb93-140" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-141"><a href="id_04_model_comparisons.html#cb93-141" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-142"><a href="id_04_model_comparisons.html#cb93-142" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 1.592 on 5 degrees of freedom</span></span>
<span id="cb93-143"><a href="id_04_model_comparisons.html#cb93-143" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6354, Adjusted R-squared:  0.5625 </span></span>
<span id="cb93-144"><a href="id_04_model_comparisons.html#cb93-144" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 8.715 on 1 and 5 DF,  p-value: 0.03181</span></span>
<span id="cb93-145"><a href="id_04_model_comparisons.html#cb93-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-146"><a href="id_04_model_comparisons.html#cb93-146" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-147"><a href="id_04_model_comparisons.html#cb93-147" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-148"><a href="id_04_model_comparisons.html#cb93-148" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Logit transform for proportion positives &amp; log transform for tree depth </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-149"><a href="id_04_model_comparisons.html#cb93-149" aria-hidden="true" tabindex="-1"></a><span class="do">## Logit transform for proportion positives &amp; log transform for tree depth</span></span>
<span id="cb93-150"><a href="id_04_model_comparisons.html#cb93-150" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-151"><a href="id_04_model_comparisons.html#cb93-151" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-152"><a href="id_04_model_comparisons.html#cb93-152" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives,</span>
<span id="cb93-153"><a href="id_04_model_comparisons.html#cb93-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-154"><a href="id_04_model_comparisons.html#cb93-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion_positives =</span> <span class="fu">logit</span>(proportion_positives),</span>
<span id="cb93-155"><a href="id_04_model_comparisons.html#cb93-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_tree_depth =</span> <span class="fu">log2</span>(mean_tree_depth)</span>
<span id="cb93-156"><a href="id_04_model_comparisons.html#cb93-156" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-157"><a href="id_04_model_comparisons.html#cb93-157" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-158"><a href="id_04_model_comparisons.html#cb93-158" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb93-159"><a href="id_04_model_comparisons.html#cb93-159" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-160"><a href="id_04_model_comparisons.html#cb93-160" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb93-161"><a href="id_04_model_comparisons.html#cb93-161" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = mean_tree_depth ~ proportion_positives, data = data.frame(proportion_positives = logit(proportion_positives), </span></span>
<span id="cb93-162"><a href="id_04_model_comparisons.html#cb93-162" aria-hidden="true" tabindex="-1"></a><span class="do">##     mean_tree_depth = log2(mean_tree_depth)))</span></span>
<span id="cb93-163"><a href="id_04_model_comparisons.html#cb93-163" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-164"><a href="id_04_model_comparisons.html#cb93-164" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb93-165"><a href="id_04_model_comparisons.html#cb93-165" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2        3        4        5        6        7 </span></span>
<span id="cb93-166"><a href="id_04_model_comparisons.html#cb93-166" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.06899 -0.21823 -0.26484  0.09247 -0.05659 -0.11887  0.63505 </span></span>
<span id="cb93-167"><a href="id_04_model_comparisons.html#cb93-167" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-168"><a href="id_04_model_comparisons.html#cb93-168" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb93-169"><a href="id_04_model_comparisons.html#cb93-169" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb93-170"><a href="id_04_model_comparisons.html#cb93-170" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)            6.8270     1.1096   6.153  0.00165 **</span></span>
<span id="cb93-171"><a href="id_04_model_comparisons.html#cb93-171" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion_positives   0.8676     0.2259   3.840  0.01212 * </span></span>
<span id="cb93-172"><a href="id_04_model_comparisons.html#cb93-172" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb93-173"><a href="id_04_model_comparisons.html#cb93-173" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-174"><a href="id_04_model_comparisons.html#cb93-174" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-175"><a href="id_04_model_comparisons.html#cb93-175" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 0.3322 on 5 degrees of freedom</span></span>
<span id="cb93-176"><a href="id_04_model_comparisons.html#cb93-176" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.7468, Adjusted R-squared:  0.6962 </span></span>
<span id="cb93-177"><a href="id_04_model_comparisons.html#cb93-177" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 14.75 on 1 and 5 DF,  p-value: 0.01212</span></span>
<span id="cb93-178"><a href="id_04_model_comparisons.html#cb93-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-179"><a href="id_04_model_comparisons.html#cb93-179" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-180"><a href="id_04_model_comparisons.html#cb93-180" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-181"><a href="id_04_model_comparisons.html#cb93-181" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Arc-sine transform for proportion positives &amp; log transform for tree depth</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-182"><a href="id_04_model_comparisons.html#cb93-182" aria-hidden="true" tabindex="-1"></a><span class="do">## Arc-sine transform for proportion positives &amp; log transform for tree depth</span></span>
<span id="cb93-183"><a href="id_04_model_comparisons.html#cb93-183" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb93-184"><a href="id_04_model_comparisons.html#cb93-184" aria-hidden="true" tabindex="-1"></a><span class="do">## ~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~</span></span>
<span id="cb93-185"><a href="id_04_model_comparisons.html#cb93-185" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives,</span>
<span id="cb93-186"><a href="id_04_model_comparisons.html#cb93-186" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-187"><a href="id_04_model_comparisons.html#cb93-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion_positives =</span> <span class="fu">asin</span>(<span class="fu">sqrt</span>(proportion_positives)),</span>
<span id="cb93-188"><a href="id_04_model_comparisons.html#cb93-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_tree_depth =</span> <span class="fu">log2</span>(mean_tree_depth)</span>
<span id="cb93-189"><a href="id_04_model_comparisons.html#cb93-189" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-190"><a href="id_04_model_comparisons.html#cb93-190" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-191"><a href="id_04_model_comparisons.html#cb93-191" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb93-192"><a href="id_04_model_comparisons.html#cb93-192" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-193"><a href="id_04_model_comparisons.html#cb93-193" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb93-194"><a href="id_04_model_comparisons.html#cb93-194" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = mean_tree_depth ~ proportion_positives, data = data.frame(proportion_positives = asin(sqrt(proportion_positives)), </span></span>
<span id="cb93-195"><a href="id_04_model_comparisons.html#cb93-195" aria-hidden="true" tabindex="-1"></a><span class="do">##     mean_tree_depth = log2(mean_tree_depth)))</span></span>
<span id="cb93-196"><a href="id_04_model_comparisons.html#cb93-196" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-197"><a href="id_04_model_comparisons.html#cb93-197" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb93-198"><a href="id_04_model_comparisons.html#cb93-198" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2        3        4        5        6        7 </span></span>
<span id="cb93-199"><a href="id_04_model_comparisons.html#cb93-199" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.00527 -0.25295 -0.28949  0.12670 -0.03982 -0.23622  0.69705 </span></span>
<span id="cb93-200"><a href="id_04_model_comparisons.html#cb93-200" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-201"><a href="id_04_model_comparisons.html#cb93-201" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb93-202"><a href="id_04_model_comparisons.html#cb93-202" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb93-203"><a href="id_04_model_comparisons.html#cb93-203" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)            0.9066     0.5417   1.673   0.1551  </span></span>
<span id="cb93-204"><a href="id_04_model_comparisons.html#cb93-204" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion_positives  18.6878     5.7926   3.226   0.0233 *</span></span>
<span id="cb93-205"><a href="id_04_model_comparisons.html#cb93-205" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb93-206"><a href="id_04_model_comparisons.html#cb93-206" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb93-207"><a href="id_04_model_comparisons.html#cb93-207" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-208"><a href="id_04_model_comparisons.html#cb93-208" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 0.3761 on 5 degrees of freedom</span></span>
<span id="cb93-209"><a href="id_04_model_comparisons.html#cb93-209" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6755, Adjusted R-squared:  0.6106 </span></span>
<span id="cb93-210"><a href="id_04_model_comparisons.html#cb93-210" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 10.41 on 1 and 5 DF,  p-value: 0.02331</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb94-1"><a href="id_04_model_comparisons.html#cb94-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb94-2"><a href="id_04_model_comparisons.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">proportion_positives =</span> <span class="fu">logit</span>(proportion_positives),</span>
<span id="cb94-3"><a href="id_04_model_comparisons.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_tree_depth =</span> <span class="fu">log2</span>(mean_tree_depth),</span>
<span id="cb94-4"><a href="id_04_model_comparisons.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper_error_tree_depth =</span> <span class="fu">log2</span>(mean_tree_depth <span class="sc">+</span> sd_tree_depth),</span>
<span id="cb94-5"><a href="id_04_model_comparisons.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower_error_tree_depth =</span> <span class="fu">log2</span>(mean_tree_depth <span class="sc">-</span> sd_tree_depth)</span>
<span id="cb94-6"><a href="id_04_model_comparisons.html#cb94-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-7"><a href="id_04_model_comparisons.html#cb94-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb94-8"><a href="id_04_model_comparisons.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;italic(P.~falciparum)~model&quot;</span>,</span>
<span id="cb94-9"><a href="id_04_model_comparisons.html#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;italic(P.~falciparum)~with~heterologous~positives~model&quot;</span>,</span>
<span id="cb94-10"><a href="id_04_model_comparisons.html#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;italic(P.~falciparum)~with~heterologous~unlabeled~model&quot;</span>,</span>
<span id="cb94-11"><a href="id_04_model_comparisons.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;italic(P.~vivax)~model&quot;</span>,</span>
<span id="cb94-12"><a href="id_04_model_comparisons.html#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;italic(P.~vivax)~with~heterologous~positives~model&quot;</span>,</span>
<span id="cb94-13"><a href="id_04_model_comparisons.html#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;italic(P.~vivax)~with~heterologous~unlabeled~model&quot;</span>,</span>
<span id="cb94-14"><a href="id_04_model_comparisons.html#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Combined~model&quot;</span></span>
<span id="cb94-15"><a href="id_04_model_comparisons.html#cb94-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-16"><a href="id_04_model_comparisons.html#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="id_04_model_comparisons.html#cb94-17" aria-hidden="true" tabindex="-1"></a>lm_eqn <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb94-18"><a href="id_04_model_comparisons.html#cb94-18" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_tree_depth <span class="sc">~</span> proportion_positives, data)</span>
<span id="cb94-19"><a href="id_04_model_comparisons.html#cb94-19" aria-hidden="true" tabindex="-1"></a>  eq <span class="ot">&lt;-</span> <span class="fu">substitute</span>(</span>
<span id="cb94-20"><a href="id_04_model_comparisons.html#cb94-20" aria-hidden="true" tabindex="-1"></a>    log[<span class="dv">2</span>](<span class="fu">italic</span>(y)) <span class="sc">==</span> a <span class="sc">+</span> b <span class="sc">%.%</span> <span class="fu">logit</span>(<span class="fu">italic</span>(x)) <span class="sc">*</span> <span class="st">&quot;,&quot;</span> <span class="sc">~</span> <span class="er">~</span> <span class="fu">italic</span>(r<span class="sc">^</span><span class="dv">2</span>) <span class="sc">~</span> <span class="st">&quot;=&quot;</span> <span class="sc">~</span> r2,</span>
<span id="cb94-21"><a href="id_04_model_comparisons.html#cb94-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb94-22"><a href="id_04_model_comparisons.html#cb94-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">a =</span> <span class="fu">format</span>(<span class="fu">unname</span>(<span class="fu">coef</span>(m)[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb94-23"><a href="id_04_model_comparisons.html#cb94-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">b =</span> <span class="fu">format</span>(<span class="fu">unname</span>(<span class="fu">coef</span>(m)[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb94-24"><a href="id_04_model_comparisons.html#cb94-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">r2 =</span> <span class="fu">format</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb94-25"><a href="id_04_model_comparisons.html#cb94-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-26"><a href="id_04_model_comparisons.html#cb94-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-27"><a href="id_04_model_comparisons.html#cb94-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(<span class="fu">as.expression</span>(eq))</span>
<span id="cb94-28"><a href="id_04_model_comparisons.html#cb94-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-29"><a href="id_04_model_comparisons.html#cb94-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-30"><a href="id_04_model_comparisons.html#cb94-30" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(proportion_positives, mean_tree_depth)) <span class="sc">+</span></span>
<span id="cb94-31"><a href="id_04_model_comparisons.html#cb94-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb94-32"><a href="id_04_model_comparisons.html#cb94-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey10&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb94-33"><a href="id_04_model_comparisons.html#cb94-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower_error_tree_depth, <span class="at">ymax =</span> upper_error_tree_depth), <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb94-34"><a href="id_04_model_comparisons.html#cb94-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> model),</span>
<span id="cb94-35"><a href="id_04_model_comparisons.html#cb94-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">segment.size =</span> <span class="fl">0.2</span>,</span>
<span id="cb94-36"><a href="id_04_model_comparisons.html#cb94-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.02</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span></span>
<span id="cb94-37"><a href="id_04_model_comparisons.html#cb94-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb94-38"><a href="id_04_model_comparisons.html#cb94-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">5.5</span>, <span class="at">y =</span> <span class="fl">3.5</span>, <span class="at">label =</span> <span class="fu">lm_eqn</span>(data), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb94-39"><a href="id_04_model_comparisons.html#cb94-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb94-40"><a href="id_04_model_comparisons.html#cb94-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">logit</span>(<span class="fu">c</span>(<span class="fl">0.004</span>, <span class="fl">0.008</span>, <span class="fl">0.012</span>, <span class="fl">0.016</span>)),</span>
<span id="cb94-41"><a href="id_04_model_comparisons.html#cb94-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fl">0.004</span>, <span class="fl">0.008</span>, <span class="fl">0.012</span>, <span class="fl">0.016</span>)</span>
<span id="cb94-42"><a href="id_04_model_comparisons.html#cb94-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb94-43"><a href="id_04_model_comparisons.html#cb94-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">log2</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb94-44"><a href="id_04_model_comparisons.html#cb94-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb94-45"><a href="id_04_model_comparisons.html#cb94-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb94-46"><a href="id_04_model_comparisons.html#cb94-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-47"><a href="id_04_model_comparisons.html#cb94-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-48"><a href="id_04_model_comparisons.html#cb94-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb94-49"><a href="id_04_model_comparisons.html#cb94-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb94-50"><a href="id_04_model_comparisons.html#cb94-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb94-51"><a href="id_04_model_comparisons.html#cb94-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb94-52"><a href="id_04_model_comparisons.html#cb94-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb94-53"><a href="id_04_model_comparisons.html#cb94-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Proportion of positives&quot;</span>) <span class="sc">+</span></span>
<span id="cb94-54"><a href="id_04_model_comparisons.html#cb94-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean tree depth&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb95-1"><a href="id_04_model_comparisons.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">&quot;./figures/Supplementary Fig 7.png&quot;</span>, <span class="at">width =</span> <span class="dv">3800</span>, <span class="at">height =</span> <span class="dv">3500</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb95-2"><a href="id_04_model_comparisons.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb95-3"><a href="id_04_model_comparisons.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb95-4"><a href="id_04_model_comparisons.html#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="id_04_model_comparisons.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;../supplementary_figures/Supplementary Fig 7.pdf&quot;</span>, <span class="at">width =</span> <span class="fl">7.6</span>, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb95-6"><a href="id_04_model_comparisons.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb95-7"><a href="id_04_model_comparisons.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%207.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb96-1"><a href="id_04_model_comparisons.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggrepel_0.9.3     psych_2.3.3       reticulate_1.28   DT_0.27          
##  [5] rcompanion_2.4.30 rlist_0.4.6.2     scales_1.2.1      ggsci_3.0.0      
##  [9] pracma_2.4.2      cowplot_1.1.1     gghalves_0.1.4    ggdist_3.2.1     
## [13] reshape2_1.4.4    ggplot2_3.4.2    
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-162         matrixStats_0.63.0   httr_1.4.6          
##  [4] rprojroot_2.0.3      R.cache_0.16.0       tools_4.2.3         
##  [7] bslib_0.4.2          utf8_1.2.3           R6_2.5.1            
## [10] nortest_1.0-4        colorspace_2.1-0     withr_2.5.0         
## [13] mnormt_2.1.1         tidyselect_1.2.0     Exact_3.2           
## [16] compiler_4.2.3       cli_3.6.1            expm_0.999-7        
## [19] sandwich_3.0-2       bookdown_0.34        sass_0.4.6          
## [22] lmtest_0.9-40        mvtnorm_1.1-3        proxy_0.4-27        
## [25] multcompView_0.1-9   stringr_1.5.0        digest_0.6.31       
## [28] rmarkdown_2.21       R.utils_2.12.2       pkgconfig_2.0.3     
## [31] htmltools_0.5.5      styler_1.9.1         fastmap_1.1.1       
## [34] highr_0.10           htmlwidgets_1.6.2    rlang_1.1.1         
## [37] readxl_1.4.2         rstudioapi_0.14      jquerylib_0.1.4     
## [40] farver_2.1.1         generics_0.1.3       zoo_1.8-12          
## [43] jsonlite_1.8.4       crosstalk_1.2.0      dplyr_1.1.2         
## [46] R.oo_1.25.0          distributional_0.3.2 magrittr_2.0.3      
## [49] modeltools_0.2-23    Matrix_1.5-4         Rcpp_1.0.10         
## [52] DescTools_0.99.48    munsell_0.5.0        fansi_1.0.4         
## [55] lifecycle_1.0.3      R.methodsS3_1.8.2    stringi_1.7.12      
## [58] multcomp_1.4-23      yaml_2.3.7           MASS_7.3-60         
## [61] rootSolve_1.8.2.3    plyr_1.8.8           grid_4.2.3          
## [64] parallel_4.2.3       lmom_2.9             lattice_0.21-8      
## [67] splines_4.2.3        knitr_1.42           pillar_1.9.0        
## [70] boot_1.3-28.1        gld_2.6.6            codetools_0.2-19    
## [73] stats4_4.2.3         glue_1.6.2           evaluate_0.21       
## [76] data.table_1.14.8    vctrs_0.6.2          png_0.1-8           
## [79] cellranger_1.1.0     gtable_0.3.3         purrr_1.0.1         
## [82] cachem_1.0.8         xfun_0.39            coin_1.4-2          
## [85] libcoin_1.0-9        e1071_1.7-13         class_7.3-22        
## [88] survival_3.5-5       tibble_3.2.1         TH.data_1.1-2       
## [91] ellipsis_0.3.2       here_1.0.1</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb98-1"><a href="id_04_model_comparisons.html#cb98-1" aria-hidden="true" tabindex="-1"></a>session_info.show()</span></code></pre></div>
<pre><code>## -----
## numpy               1.19.0
## pandas              1.3.2
## purf                NA
## session_info        1.0.0
## -----
## Python 3.8.2 (default, Mar 26 2020, 10:45:18) [Clang 4.0.1 (tags/RELEASE_401/final)]
## macOS-10.16-x86_64-i386-64bit
## -----
## Session information updated at 2023-05-18 12:35</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_03_model_evaluation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="id_05_model_interpretation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["main_notebook.pdf", "PDF"]],
"search": false,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
