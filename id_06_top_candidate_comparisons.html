<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 6 Top candidate comparisons | Malaria vaccine antigen identification for Plasmodium vivax</title>
  <meta name="description" content="Section 6 Top candidate comparisons | Malaria vaccine antigen identification for Plasmodium vivax" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 6 Top candidate comparisons | Malaria vaccine antigen identification for Plasmodium vivax" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 6 Top candidate comparisons | Malaria vaccine antigen identification for Plasmodium vivax" />
  
  
  

<meta name="author" content="Renee Ti Chou" />


<meta name="date" content="2023-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_05_model_interpretation.html"/>
<link rel="next" href="id_07_summary_of_candidates.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.12.1/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.12.1/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<!-- https://stackoverflow.com/questions/45360998/code-folding-in-bookdown -->
<script type="text/javascript" src="js/transition.js"></script>
<script type="text/javascript" src="js/dropdown.js"></script>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><i>Positive-unlabeled learning for Pv RV</i></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html"><i class="fa fa-check"></i><b>1</b> Data engineering</a>
<ul>
<li class="chapter" data-level="1.1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#purf-package-installization"><i class="fa fa-check"></i><b>1.1</b> <code>purf</code> package installization</a></li>
<li class="chapter" data-level="1.2" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#retrieving-p.-vivax-protein-variables"><i class="fa fa-check"></i><b>1.2</b> Retrieving <em>P. vivax</em> protein variables</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#immunological-data-sets"><i class="fa fa-check"></i><b>1.2.1</b> Immunological data sets</a></li>
<li class="chapter" data-level="1.2.2" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#proteomic-data-sets"><i class="fa fa-check"></i><b>1.2.2</b> Proteomic data sets</a></li>
<li class="chapter" data-level="1.2.3" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#structural-data-sets"><i class="fa fa-check"></i><b>1.2.3</b> Structural data sets</a></li>
<li class="chapter" data-level="1.2.4" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#genomic-data-sets"><i class="fa fa-check"></i><b>1.2.4</b> Genomic data sets</a></li>
<li class="chapter" data-level="1.2.5" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#final-assembly"><i class="fa fa-check"></i><b>1.2.5</b> Final assembly</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#generating-ml-input"><i class="fa fa-check"></i><b>1.3</b> Generating ML input</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="id_02_model_training.html"><a href="id_02_model_training.html"><i class="fa fa-check"></i><b>2</b> Model training</a>
<ul>
<li class="chapter" data-level="2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#hyper-parameter-tuning-for-purf"><i class="fa fa-check"></i><b>2.1</b> Hyper-parameter tuning for PURF</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#analysis"><i class="fa fa-check"></i><b>2.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-data-set"><i class="fa fa-check"></i><b>2.1.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-pf-combined-data-set"><i class="fa fa-check"></i><b>2.1.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="2.1.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#plotting"><i class="fa fa-check"></i><b>2.1.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="2.1.2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-data-set-1"><i class="fa fa-check"></i><b>2.1.2.1</b> Pv data set</a></li>
<li class="chapter" data-level="2.1.2.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#bimodal-distribution-plot"><i class="fa fa-check"></i><b>2.1.2.2</b> Bimodal distribution plot</a></li>
<li class="chapter" data-level="2.1.2.3" data-path="id_02_model_training.html"><a href="id_02_model_training.html#known-antigen-ranking"><i class="fa fa-check"></i><b>2.1.2.3</b> Known antigen ranking</a></li>
<li class="chapter" data-level="2.1.2.4" data-path="id_02_model_training.html"><a href="id_02_model_training.html#pv-pf-combined-data-set-1"><i class="fa fa-check"></i><b>2.1.2.4</b> Pv + Pf combined data set</a></li>
<li class="chapter" data-level="2.1.2.5" data-path="id_02_model_training.html"><a href="id_02_model_training.html#bimodal-distribution-plot-1"><i class="fa fa-check"></i><b>2.1.2.5</b> Bimodal distribution plot</a></li>
<li class="chapter" data-level="2.1.2.6" data-path="id_02_model_training.html"><a href="id_02_model_training.html#known-antigen-ranking-1"><i class="fa fa-check"></i><b>2.1.2.6</b> Known antigen ranking</a></li>
</ul></li>
<li class="chapter" data-level="2.1.3" data-path="id_02_model_training.html"><a href="id_02_model_training.html#results-for-positive-level-0.5"><i class="fa fa-check"></i><b>2.1.3</b> Results for positive level = 0.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html"><i class="fa fa-check"></i><b>3</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#known-antigen-prediction-accuracy"><i class="fa fa-check"></i><b>3.1</b> Known antigen prediction accuracy</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#analysis-1"><i class="fa fa-check"></i><b>3.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="3.1.1.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pv-model-cross-species-predictions"><i class="fa fa-check"></i><b>3.1.1.1</b> Pv model cross-species predictions</a></li>
<li class="chapter" data-level="3.1.1.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pf-model-cross-species-predictions"><i class="fa fa-check"></i><b>3.1.1.2</b> Pf model cross-species predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#adversarial-controls"><i class="fa fa-check"></i><b>3.2</b> Adversarial controls</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#analysis-2"><i class="fa fa-check"></i><b>3.2.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="3.2.1.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pv-data-set-2"><i class="fa fa-check"></i><b>3.2.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="3.2.1.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#pv-pf-combined-data-set-2"><i class="fa fa-check"></i><b>3.2.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="3.2.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#plotting-1"><i class="fa fa-check"></i><b>3.2.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="3.2.2.1" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#mean-differences-in-scores"><i class="fa fa-check"></i><b>3.2.2.1</b> Mean differences in scores</a></li>
<li class="chapter" data-level="3.2.2.2" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#investigation-of-known-antigen-groups"><i class="fa fa-check"></i><b>3.2.2.2</b> Investigation of known antigen groups</a></li>
<li class="chapter" data-level="3.2.2.3" data-path="id_03_model_evaluation.html"><a href="id_03_model_evaluation.html#labeled-known-antigen-accuracies"><i class="fa fa-check"></i><b>3.2.2.3</b> Labeled known antigen accuracies</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html"><i class="fa fa-check"></i><b>4</b> Model comparisons</a>
<ul>
<li class="chapter" data-level="4.1" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#known-antigen-score-comparisons"><i class="fa fa-check"></i><b>4.1</b> Known antigen score comparisons</a></li>
<li class="chapter" data-level="4.2" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#known-antigen-prediction-summary"><i class="fa fa-check"></i><b>4.2</b> Known antigen prediction summary</a></li>
<li class="chapter" data-level="4.3" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#score-and-species-association"><i class="fa fa-check"></i><b>4.3</b> Score and species association</a></li>
<li class="chapter" data-level="4.4" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#tree-depth-analysis"><i class="fa fa-check"></i><b>4.4</b> Tree depth analysis</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#analysis-3"><i class="fa fa-check"></i><b>4.4.1</b> Analysis</a></li>
<li class="chapter" data-level="4.4.2" data-path="id_04_model_comparisons.html"><a href="id_04_model_comparisons.html#plotting-2"><i class="fa fa-check"></i><b>4.4.2</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html"><i class="fa fa-check"></i><b>5</b> Model interpretation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#proximity-matrix-calculation"><i class="fa fa-check"></i><b>5.1</b> Proximity matrix calculation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-4"><i class="fa fa-check"></i><b>5.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="5.1.1.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-data-set-3"><i class="fa fa-check"></i><b>5.1.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="5.1.1.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-3"><i class="fa fa-check"></i><b>5.1.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="5.1.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#plotting-3"><i class="fa fa-check"></i><b>5.1.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="5.1.2.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-4"><i class="fa fa-check"></i><b>5.1.2.1</b> Pv + Pf combined data set</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#clustering-of-predicted-positives"><i class="fa fa-check"></i><b>5.2</b> Clustering of predicted positives</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-5"><i class="fa fa-check"></i><b>5.2.1</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#comparison-of-amino-acid-frequencies-between-species"><i class="fa fa-check"></i><b>5.3</b> Comparison of amino acid frequencies between species</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-6"><i class="fa fa-check"></i><b>5.3.1</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#variable-importance"><i class="fa fa-check"></i><b>5.4</b> Variable importance</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#analysis-7"><i class="fa fa-check"></i><b>5.4.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="5.4.1.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-data-set-4"><i class="fa fa-check"></i><b>5.4.1.1</b> Pv data set</a></li>
<li class="chapter" data-level="5.4.1.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-5"><i class="fa fa-check"></i><b>5.4.1.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="5.4.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#plotting-4"><i class="fa fa-check"></i><b>5.4.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="5.4.2.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-data-set-5"><i class="fa fa-check"></i><b>5.4.2.1</b> Pv data set</a></li>
<li class="chapter" data-level="5.4.2.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#pv-pf-combined-data-set-6"><i class="fa fa-check"></i><b>5.4.2.2</b> Pv + Pf combined data set</a></li>
</ul></li>
<li class="chapter" data-level="5.4.3" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#comparison-of-top-10-important-variables"><i class="fa fa-check"></i><b>5.4.3</b> Comparison of top 10 important variables</a>
<ul>
<li class="chapter" data-level="5.4.3.1" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#venn-diagram"><i class="fa fa-check"></i><b>5.4.3.1</b> Venn diagram</a></li>
<li class="chapter" data-level="5.4.3.2" data-path="id_05_model_interpretation.html"><a href="id_05_model_interpretation.html#top-10-variables-from-combined-model"><i class="fa fa-check"></i><b>5.4.3.2</b> Top 10 variables from combined model</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html"><i class="fa fa-check"></i><b>6</b> Top candidate comparisons</a>
<ul>
<li class="chapter" data-level="6.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#clustering-analysis"><i class="fa fa-check"></i><b>6.1</b> Clustering analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#analysis-8"><i class="fa fa-check"></i><b>6.1.1</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#gene-ontology-analysis"><i class="fa fa-check"></i><b>6.2</b> Gene ontology analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#analysis-9"><i class="fa fa-check"></i><b>6.2.1</b> Analysis</a></li>
<li class="chapter" data-level="6.2.2" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#plotting-5"><i class="fa fa-check"></i><b>6.2.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#candidate-antigen-characterization"><i class="fa fa-check"></i><b>6.3</b> Candidate antigen characterization</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="id_06_top_candidate_comparisons.html"><a href="id_06_top_candidate_comparisons.html#processing-table"><i class="fa fa-check"></i><b>6.3.1</b> Processing table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="id_07_summary_of_candidates.html"><a href="id_07_summary_of_candidates.html"><i class="fa fa-check"></i><b>7</b> Summary of candidates</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Malaria vaccine antigen identification for <em>Plasmodium vivax</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="id_06_top_candidate_comparisons" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Section 6</span> Top candidate comparisons<a href="id_06_top_candidate_comparisons.html#id_06_top_candidate_comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="clustering-analysis" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Clustering analysis<a href="id_06_top_candidate_comparisons.html#clustering-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="analysis-8" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Analysis<a href="id_06_top_candidate_comparisons.html#analysis-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb165-1"><a href="id_06_top_candidate_comparisons.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb165-2"><a href="id_06_top_candidate_comparisons.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb165-3"><a href="id_06_top_candidate_comparisons.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb165-4"><a href="id_06_top_candidate_comparisons.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb165-5"><a href="id_06_top_candidate_comparisons.html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb165-6"><a href="id_06_top_candidate_comparisons.html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb166-1"><a href="id_06_top_candidate_comparisons.html#cb166-1" aria-hidden="true" tabindex="-1"></a>pfpv_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_5_pfpv_purf_oob_predictions.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb166-2"><a href="id_06_top_candidate_comparisons.html#cb166-2" aria-hidden="true" tabindex="-1"></a>pfpv_data <span class="ot">&lt;-</span> pfpv_data[<span class="fu">order</span>(<span class="sc">-</span>pfpv_data<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>), ]</span>
<span id="cb166-3"><a href="id_06_top_candidate_comparisons.html#cb166-3" aria-hidden="true" tabindex="-1"></a>pfpv_threshold <span class="ot">&lt;-</span> pfpv_data[pfpv_data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>[<span class="fu">sum</span>(pfpv_data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>]</span>
<span id="cb166-4"><a href="id_06_top_candidate_comparisons.html#cb166-4" aria-hidden="true" tabindex="-1"></a>top_pf_pfpv <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pfpv_data[pfpv_data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">&quot;pf&quot;</span> <span class="sc">&amp;</span> pfpv_data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> pfpv_data<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span> <span class="sc">&gt;=</span> pfpv_threshold, ])</span>
<span id="cb166-5"><a href="id_06_top_candidate_comparisons.html#cb166-5" aria-hidden="true" tabindex="-1"></a>top_pv_pfpv <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pfpv_data[pfpv_data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">&quot;pv&quot;</span> <span class="sc">&amp;</span> pfpv_data<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> pfpv_data<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span> <span class="sc">&gt;=</span> pfpv_threshold, ])</span></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb167-1"><a href="id_06_top_candidate_comparisons.html#cb167-1" aria-hidden="true" tabindex="-1"></a>pfpv_prox <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Downloads/pfpv_proximity_values.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb167-2"><a href="id_06_top_candidate_comparisons.html#cb167-2" aria-hidden="true" tabindex="-1"></a>pfpv_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pfpv_prox</span>
<span id="cb167-3"><a href="id_06_top_candidate_comparisons.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pfpv_dist) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(pfpv_dist)</span>
<span id="cb167-4"><a href="id_06_top_candidate_comparisons.html#cb167-4" aria-hidden="true" tabindex="-1"></a>pfpv_dist <span class="ot">&lt;-</span> pfpv_dist[</span>
<span id="cb167-5"><a href="id_06_top_candidate_comparisons.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(pfpv_dist) <span class="sc">%in%</span> <span class="fu">c</span>(top_pf_pfpv, top_pv_pfpv),</span>
<span id="cb167-6"><a href="id_06_top_candidate_comparisons.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(pfpv_dist) <span class="sc">%in%</span> <span class="fu">c</span>(top_pf_pfpv, top_pv_pfpv)</span>
<span id="cb167-7"><a href="id_06_top_candidate_comparisons.html#cb167-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb167-8"><a href="id_06_top_candidate_comparisons.html#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(pfpv_prox)</span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb168-1"><a href="id_06_top_candidate_comparisons.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gap statistic</span></span>
<span id="cb168-2"><a href="id_06_top_candidate_comparisons.html#cb168-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(pfpv_dist, <span class="at">K.max =</span> <span class="dv">10</span>, hcut, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">hc_method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb168-3"><a href="id_06_top_candidate_comparisons.html#cb168-3" aria-hidden="true" tabindex="-1"></a>p0_1 <span class="ot">&lt;-</span> <span class="fu">fviz_gap_stat</span>(gap_stat, <span class="at">maxSE =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;Tibs2001SEmax&quot;</span>, <span class="at">SE.factor =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb168-4"><a href="id_06_top_candidate_comparisons.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gap statistic method&quot;</span>)</span>
<span id="cb168-5"><a href="id_06_top_candidate_comparisons.html#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="id_06_top_candidate_comparisons.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Silhouette method</span></span>
<span id="cb168-7"><a href="id_06_top_candidate_comparisons.html#cb168-7" aria-hidden="true" tabindex="-1"></a>p0_2 <span class="ot">&lt;-</span> <span class="fu">fviz_nbclust</span>(pfpv_dist, <span class="at">k.max =</span> <span class="dv">10</span>, hcut, <span class="at">hc_method =</span> <span class="st">&quot;ward.D2&quot;</span>, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>) <span class="sc">+</span></span>
<span id="cb168-8"><a href="id_06_top_candidate_comparisons.html#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Silhouette method&quot;</span>)</span>
<span id="cb168-9"><a href="id_06_top_candidate_comparisons.html#cb168-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-10"><a href="id_06_top_candidate_comparisons.html#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Elbow method</span></span>
<span id="cb168-11"><a href="id_06_top_candidate_comparisons.html#cb168-11" aria-hidden="true" tabindex="-1"></a>p0_3 <span class="ot">&lt;-</span> <span class="fu">fviz_nbclust</span>(pfpv_dist, <span class="at">k.max =</span> <span class="dv">10</span>, hcut, <span class="at">hc_method =</span> <span class="st">&quot;ward.D2&quot;</span>, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>) <span class="sc">+</span></span>
<span id="cb168-12"><a href="id_06_top_candidate_comparisons.html#cb168-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">3</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb168-13"><a href="id_06_top_candidate_comparisons.html#cb168-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Elbow method&quot;</span>)</span>
<span id="cb168-14"><a href="id_06_top_candidate_comparisons.html#cb168-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-15"><a href="id_06_top_candidate_comparisons.html#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(p0_1, p0_2, p0_3, <span class="at">file =</span> <span class="st">&quot;./rdata/top_candidate_optimal_num_clusters.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb169-1"><a href="id_06_top_candidate_comparisons.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(umap)</span>
<span id="cb169-2"><a href="id_06_top_candidate_comparisons.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb169-3"><a href="id_06_top_candidate_comparisons.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb169-4"><a href="id_06_top_candidate_comparisons.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb170-1"><a href="id_06_top_candidate_comparisons.html#cb170-1" aria-hidden="true" tabindex="-1"></a>top_pfpv_hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">as.dist</span>(pfpv_dist), <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb170-2"><a href="id_06_top_candidate_comparisons.html#cb170-2" aria-hidden="true" tabindex="-1"></a>top_pfpv_2_clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(top_pfpv_hc, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb170-3"><a href="id_06_top_candidate_comparisons.html#cb170-3" aria-hidden="true" tabindex="-1"></a>top_pfpv_3_clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(top_pfpv_hc, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb170-4"><a href="id_06_top_candidate_comparisons.html#cb170-4" aria-hidden="true" tabindex="-1"></a>top_pfpv_2_clusters[top_pfpv_2_clusters <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb170-5"><a href="id_06_top_candidate_comparisons.html#cb170-5" aria-hidden="true" tabindex="-1"></a>top_pfpv_2_clusters[top_pfpv_2_clusters <span class="sc">==</span> <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb170-6"><a href="id_06_top_candidate_comparisons.html#cb170-6" aria-hidden="true" tabindex="-1"></a>top_pfpv_2_clusters <span class="ot">&lt;-</span> top_pfpv_2_clusters <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb170-7"><a href="id_06_top_candidate_comparisons.html#cb170-7" aria-hidden="true" tabindex="-1"></a>top_pfpv_3_clusters[top_pfpv_3_clusters <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb170-8"><a href="id_06_top_candidate_comparisons.html#cb170-8" aria-hidden="true" tabindex="-1"></a>top_pfpv_3_clusters[top_pfpv_3_clusters <span class="sc">==</span> <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb170-9"><a href="id_06_top_candidate_comparisons.html#cb170-9" aria-hidden="true" tabindex="-1"></a>top_pfpv_3_clusters[top_pfpv_3_clusters <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb170-10"><a href="id_06_top_candidate_comparisons.html#cb170-10" aria-hidden="true" tabindex="-1"></a>top_pfpv_3_clusters <span class="ot">&lt;-</span> top_pfpv_3_clusters <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb170-11"><a href="id_06_top_candidate_comparisons.html#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(top_pfpv_2_clusters, top_pfpv_3_clusters,</span>
<span id="cb170-12"><a href="id_06_top_candidate_comparisons.html#cb170-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./rdata/top_candidate_clusters.RData&quot;</span></span>
<span id="cb170-13"><a href="id_06_top_candidate_comparisons.html#cb170-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb171-1"><a href="id_06_top_candidate_comparisons.html#cb171-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> top_pfpv_2_clusters</span>
<span id="cb171-2"><a href="id_06_top_candidate_comparisons.html#cb171-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_5_pfpv_purf_oob_predictions.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb171-3"><a href="id_06_top_candidate_comparisons.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./rdata/pfpv_prox_mds_umap.RData&quot;</span>)</span>
<span id="cb171-4"><a href="id_06_top_candidate_comparisons.html#cb171-4" aria-hidden="true" tabindex="-1"></a>umap_df_ <span class="ot">&lt;-</span> umap_df</span>
<span id="cb171-5"><a href="id_06_top_candidate_comparisons.html#cb171-5" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>label <span class="ot">&lt;-</span> data<span class="sc">$</span>antigen_label</span>
<span id="cb171-6"><a href="id_06_top_candidate_comparisons.html#cb171-6" aria-hidden="true" tabindex="-1"></a>umap_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>, ], umap_df[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters), ])</span>
<span id="cb171-7"><a href="id_06_top_candidate_comparisons.html#cb171-7" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb171-8"><a href="id_06_top_candidate_comparisons.html#cb171-8" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Known antigen&quot;</span></span>
<span id="cb171-9"><a href="id_06_top_candidate_comparisons.html#cb171-9" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Reference antigen&quot;</span></span>
<span id="cb171-10"><a href="id_06_top_candidate_comparisons.html#cb171-10" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;Group 1&quot;</span></span>
<span id="cb171-11"><a href="id_06_top_candidate_comparisons.html#cb171-11" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;Group 2&quot;</span></span>
<span id="cb171-12"><a href="id_06_top_candidate_comparisons.html#cb171-12" aria-hidden="true" tabindex="-1"></a>umap_df_text <span class="ot">&lt;-</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb171-13"><a href="id_06_top_candidate_comparisons.html#cb171-13" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb171-14"><a href="id_06_top_candidate_comparisons.html#cb171-14" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PfCSP&quot;</span></span>
<span id="cb171-15"><a href="id_06_top_candidate_comparisons.html#cb171-15" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;RH5&quot;</span></span>
<span id="cb171-16"><a href="id_06_top_candidate_comparisons.html#cb171-16" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;MSP5&quot;</span></span>
<span id="cb171-17"><a href="id_06_top_candidate_comparisons.html#cb171-17" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;P230&quot;</span></span>
<span id="cb171-18"><a href="id_06_top_candidate_comparisons.html#cb171-18" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PVP01_0835600.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PvCSP&quot;</span></span>
<span id="cb171-19"><a href="id_06_top_candidate_comparisons.html#cb171-19" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PVP01_0623800.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DBP&quot;</span></span>
<span id="cb171-20"><a href="id_06_top_candidate_comparisons.html#cb171-20" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PVP01_0728900.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;MSP1&quot;</span></span>
<span id="cb171-21"><a href="id_06_top_candidate_comparisons.html#cb171-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-22"><a href="id_06_top_candidate_comparisons.html#cb171-22" aria-hidden="true" tabindex="-1"></a>umap_p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb171-23"><a href="id_06_top_candidate_comparisons.html#cb171-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> umap_df_, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2), <span class="at">color =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb171-24"><a href="id_06_top_candidate_comparisons.html#cb171-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb171-25"><a href="id_06_top_candidate_comparisons.html#cb171-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb171-26"><a href="id_06_top_candidate_comparisons.html#cb171-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#FFFF33&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb171-27"><a href="id_06_top_candidate_comparisons.html#cb171-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb171-28"><a href="id_06_top_candidate_comparisons.html#cb171-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">0</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">fill =</span> group), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb171-29"><a href="id_06_top_candidate_comparisons.html#cb171-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb171-30"><a href="id_06_top_candidate_comparisons.html#cb171-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> umap_df_text, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> label_text), <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb171-31"><a href="id_06_top_candidate_comparisons.html#cb171-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">1.5</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span></span>
<span id="cb171-32"><a href="id_06_top_candidate_comparisons.html#cb171-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb171-33"><a href="id_06_top_candidate_comparisons.html#cb171-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="st">&quot;Group 2&quot;</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#03a1fc&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb171-34"><a href="id_06_top_candidate_comparisons.html#cb171-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb171-35"><a href="id_06_top_candidate_comparisons.html#cb171-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb171-36"><a href="id_06_top_candidate_comparisons.html#cb171-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb171-37"><a href="id_06_top_candidate_comparisons.html#cb171-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb171-38"><a href="id_06_top_candidate_comparisons.html#cb171-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb171-39"><a href="id_06_top_candidate_comparisons.html#cb171-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb171-40"><a href="id_06_top_candidate_comparisons.html#cb171-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb171-41"><a href="id_06_top_candidate_comparisons.html#cb171-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb171-42"><a href="id_06_top_candidate_comparisons.html#cb171-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb171-43"><a href="id_06_top_candidate_comparisons.html#cb171-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb171-44"><a href="id_06_top_candidate_comparisons.html#cb171-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Dimension 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb171-45"><a href="id_06_top_candidate_comparisons.html#cb171-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Dimension 2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb172-1"><a href="id_06_top_candidate_comparisons.html#cb172-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> top_pfpv_3_clusters</span>
<span id="cb172-2"><a href="id_06_top_candidate_comparisons.html#cb172-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_5_pfpv_purf_oob_predictions.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb172-3"><a href="id_06_top_candidate_comparisons.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./rdata/pfpv_prox_mds_umap.RData&quot;</span>)</span>
<span id="cb172-4"><a href="id_06_top_candidate_comparisons.html#cb172-4" aria-hidden="true" tabindex="-1"></a>umap_df_ <span class="ot">&lt;-</span> umap_df</span>
<span id="cb172-5"><a href="id_06_top_candidate_comparisons.html#cb172-5" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>label <span class="ot">&lt;-</span> data<span class="sc">$</span>antigen_label</span>
<span id="cb172-6"><a href="id_06_top_candidate_comparisons.html#cb172-6" aria-hidden="true" tabindex="-1"></a>umap_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>, ], umap_df[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters), ])</span>
<span id="cb172-7"><a href="id_06_top_candidate_comparisons.html#cb172-7" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb172-8"><a href="id_06_top_candidate_comparisons.html#cb172-8" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Known antigen&quot;</span></span>
<span id="cb172-9"><a href="id_06_top_candidate_comparisons.html#cb172-9" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Reference antigen&quot;</span></span>
<span id="cb172-10"><a href="id_06_top_candidate_comparisons.html#cb172-10" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;Group 1&quot;</span></span>
<span id="cb172-11"><a href="id_06_top_candidate_comparisons.html#cb172-11" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;Group 2&quot;</span></span>
<span id="cb172-12"><a href="id_06_top_candidate_comparisons.html#cb172-12" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>group[<span class="fu">rownames</span>(umap_df) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;Group 3&quot;</span></span>
<span id="cb172-13"><a href="id_06_top_candidate_comparisons.html#cb172-13" aria-hidden="true" tabindex="-1"></a>umap_df_text <span class="ot">&lt;-</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb172-14"><a href="id_06_top_candidate_comparisons.html#cb172-14" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb172-15"><a href="id_06_top_candidate_comparisons.html#cb172-15" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PfCSP&quot;</span></span>
<span id="cb172-16"><a href="id_06_top_candidate_comparisons.html#cb172-16" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;RH5&quot;</span></span>
<span id="cb172-17"><a href="id_06_top_candidate_comparisons.html#cb172-17" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;MSP5&quot;</span></span>
<span id="cb172-18"><a href="id_06_top_candidate_comparisons.html#cb172-18" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;P230&quot;</span></span>
<span id="cb172-19"><a href="id_06_top_candidate_comparisons.html#cb172-19" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PVP01_0835600.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PvCSP&quot;</span></span>
<span id="cb172-20"><a href="id_06_top_candidate_comparisons.html#cb172-20" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PVP01_0623800.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DBP&quot;</span></span>
<span id="cb172-21"><a href="id_06_top_candidate_comparisons.html#cb172-21" aria-hidden="true" tabindex="-1"></a>umap_df_text<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_text) <span class="sc">==</span> <span class="st">&quot;PVP01_0728900.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;MSP1&quot;</span></span>
<span id="cb172-22"><a href="id_06_top_candidate_comparisons.html#cb172-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-23"><a href="id_06_top_candidate_comparisons.html#cb172-23" aria-hidden="true" tabindex="-1"></a>umap_p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb172-24"><a href="id_06_top_candidate_comparisons.html#cb172-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> umap_df_, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2), <span class="at">color =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb172-25"><a href="id_06_top_candidate_comparisons.html#cb172-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb172-26"><a href="id_06_top_candidate_comparisons.html#cb172-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">1</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb172-27"><a href="id_06_top_candidate_comparisons.html#cb172-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#FFFF33&quot;</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb172-28"><a href="id_06_top_candidate_comparisons.html#cb172-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb172-29"><a href="id_06_top_candidate_comparisons.html#cb172-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">==</span> <span class="dv">0</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">fill =</span> group), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb172-30"><a href="id_06_top_candidate_comparisons.html#cb172-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb172-31"><a href="id_06_top_candidate_comparisons.html#cb172-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> umap_df_text, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> label_text), <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb172-32"><a href="id_06_top_candidate_comparisons.html#cb172-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">1.5</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span></span>
<span id="cb172-33"><a href="id_06_top_candidate_comparisons.html#cb172-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb172-34"><a href="id_06_top_candidate_comparisons.html#cb172-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb172-35"><a href="id_06_top_candidate_comparisons.html#cb172-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="st">&quot;Group 2&quot;</span>, <span class="st">&quot;Group 3&quot;</span>),</span>
<span id="cb172-36"><a href="id_06_top_candidate_comparisons.html#cb172-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#03a1fc&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>, <span class="st">&quot;#FF7F00&quot;</span>)</span>
<span id="cb172-37"><a href="id_06_top_candidate_comparisons.html#cb172-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb172-38"><a href="id_06_top_candidate_comparisons.html#cb172-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb172-39"><a href="id_06_top_candidate_comparisons.html#cb172-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb172-40"><a href="id_06_top_candidate_comparisons.html#cb172-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb172-41"><a href="id_06_top_candidate_comparisons.html#cb172-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb172-42"><a href="id_06_top_candidate_comparisons.html#cb172-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb172-43"><a href="id_06_top_candidate_comparisons.html#cb172-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb172-44"><a href="id_06_top_candidate_comparisons.html#cb172-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb172-45"><a href="id_06_top_candidate_comparisons.html#cb172-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb172-46"><a href="id_06_top_candidate_comparisons.html#cb172-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb172-47"><a href="id_06_top_candidate_comparisons.html#cb172-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb172-48"><a href="id_06_top_candidate_comparisons.html#cb172-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Dimension 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb172-49"><a href="id_06_top_candidate_comparisons.html#cb172-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Dimension 2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb173-1"><a href="id_06_top_candidate_comparisons.html#cb173-1" aria-hidden="true" tabindex="-1"></a>umap_p_combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(umap_p1, umap_p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb173-2"><a href="id_06_top_candidate_comparisons.html#cb173-2" aria-hidden="true" tabindex="-1"></a>umap_p_combined</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%2012.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb174-1"><a href="id_06_top_candidate_comparisons.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/top_candidate_clusters.RData&quot;</span>)</span>
<span id="cb174-2"><a href="id_06_top_candidate_comparisons.html#cb174-2" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;pf&quot;</span>, <span class="dv">145</span>), <span class="fu">rep</span>(<span class="st">&quot;pv&quot;</span>, <span class="dv">45</span>))</span>
<span id="cb174-3"><a href="id_06_top_candidate_comparisons.html#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Two clusters</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Two clusters</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb176-1"><a href="id_06_top_candidate_comparisons.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(top_pfpv_2_clusters, species)</span></code></pre></div>
<pre><code>##                    species
## top_pfpv_2_clusters  pf  pv
##                   1   0  35
##                   2 145  10</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb178-1"><a href="id_06_top_candidate_comparisons.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Three clusters</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Three clusters</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb180-1"><a href="id_06_top_candidate_comparisons.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(top_pfpv_3_clusters, species)</span></code></pre></div>
<pre><code>##                    species
## top_pfpv_3_clusters  pf  pv
##                   1   0  35
##                   2 107   9
##                   3  38   1</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb182-1"><a href="id_06_top_candidate_comparisons.html#cb182-1" aria-hidden="true" tabindex="-1"></a>protein_id_1 <span class="ot">&lt;-</span> <span class="fu">names</span>(top_pfpv_3_clusters)[top_pfpv_3_clusters <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb182-2"><a href="id_06_top_candidate_comparisons.html#cb182-2" aria-hidden="true" tabindex="-1"></a>protein_id_2 <span class="ot">&lt;-</span> <span class="fu">names</span>(top_pfpv_3_clusters)[top_pfpv_3_clusters <span class="sc">==</span> <span class="dv">2</span>]</span>
<span id="cb182-3"><a href="id_06_top_candidate_comparisons.html#cb182-3" aria-hidden="true" tabindex="-1"></a>protein_id_3 <span class="ot">&lt;-</span> <span class="fu">names</span>(top_pfpv_3_clusters)[top_pfpv_3_clusters <span class="sc">==</span> <span class="dv">3</span>]</span>
<span id="cb182-4"><a href="id_06_top_candidate_comparisons.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(protein_id_1, protein_id_2, protein_id_3, <span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span>
<span id="cb182-5"><a href="id_06_top_candidate_comparisons.html#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="id_06_top_candidate_comparisons.html#cb182-6" aria-hidden="true" tabindex="-1"></a>gene_accession_1 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(protein_id_1, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[1-9]-p1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb182-7"><a href="id_06_top_candidate_comparisons.html#cb182-7" aria-hidden="true" tabindex="-1"></a>gene_accession_2 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(protein_id_2, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[1-9]-p1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb182-8"><a href="id_06_top_candidate_comparisons.html#cb182-8" aria-hidden="true" tabindex="-1"></a>gene_accession_3 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(protein_id_3, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[1-9]-p1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb182-9"><a href="id_06_top_candidate_comparisons.html#cb182-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-10"><a href="id_06_top_candidate_comparisons.html#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">&quot;acc&quot;</span> <span class="ot">=</span> gene_accession_1),</span>
<span id="cb182-11"><a href="id_06_top_candidate_comparisons.html#cb182-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb182-12"><a href="id_06_top_candidate_comparisons.html#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./other_data/top_candidates_gene_accession_1.csv&quot;</span></span>
<span id="cb182-13"><a href="id_06_top_candidate_comparisons.html#cb182-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-14"><a href="id_06_top_candidate_comparisons.html#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">&quot;acc&quot;</span> <span class="ot">=</span> gene_accession_2),</span>
<span id="cb182-15"><a href="id_06_top_candidate_comparisons.html#cb182-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb182-16"><a href="id_06_top_candidate_comparisons.html#cb182-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./other_data/top_candidates_gene_accession_2.csv&quot;</span></span>
<span id="cb182-17"><a href="id_06_top_candidate_comparisons.html#cb182-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-18"><a href="id_06_top_candidate_comparisons.html#cb182-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">&quot;acc&quot;</span> <span class="ot">=</span> gene_accession_3),</span>
<span id="cb182-19"><a href="id_06_top_candidate_comparisons.html#cb182-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb182-20"><a href="id_06_top_candidate_comparisons.html#cb182-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./other_data/top_candidates_gene_accession_3.csv&quot;</span></span>
<span id="cb182-21"><a href="id_06_top_candidate_comparisons.html#cb182-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="gene-ontology-analysis" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Gene ontology analysis<a href="id_06_top_candidate_comparisons.html#gene-ontology-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="analysis-9" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Analysis<a href="id_06_top_candidate_comparisons.html#analysis-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In Bash: </strong></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode bash fold-hide"><code class="sourceCode bash"><span id="cb183-1"><a href="id_06_top_candidate_comparisons.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> ./other_data/goea.py <span class="at">-s</span> <span class="st">&quot;./other_data/top_candidates_gene_accession_1.csv&quot;</span> <span class="dt">\</span></span>
<span id="cb183-2"><a href="id_06_top_candidate_comparisons.html#cb183-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-p</span> <span class="st">&quot;./other_data/PlasmoDB-62_pfpv_GO.gaf&quot;</span> <span class="dt">\</span></span>
<span id="cb183-3"><a href="id_06_top_candidate_comparisons.html#cb183-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-n</span> <span class="st">&quot;./other_data/go-basic.obo&quot;</span> <span class="dt">\</span></span>
<span id="cb183-4"><a href="id_06_top_candidate_comparisons.html#cb183-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-o</span> <span class="st">&quot;./other_data/goea_result_1.xlsx&quot;</span></span>
<span id="cb183-5"><a href="id_06_top_candidate_comparisons.html#cb183-5" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb183-6"><a href="id_06_top_candidate_comparisons.html#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> ./other_data/goea.py <span class="at">-s</span> <span class="st">&quot;./other_data/top_candidates_gene_accession_2.csv&quot;</span> <span class="dt">\</span></span>
<span id="cb183-7"><a href="id_06_top_candidate_comparisons.html#cb183-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-p</span> <span class="st">&quot;./other_data/PlasmoDB-62_pfpv_GO.gaf&quot;</span> <span class="dt">\</span></span>
<span id="cb183-8"><a href="id_06_top_candidate_comparisons.html#cb183-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-n</span> <span class="st">&quot;./other_data/go-basic.obo&quot;</span> <span class="dt">\</span></span>
<span id="cb183-9"><a href="id_06_top_candidate_comparisons.html#cb183-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-o</span> <span class="st">&quot;./other_data/goea_result_2.xlsx&quot;</span></span>
<span id="cb183-10"><a href="id_06_top_candidate_comparisons.html#cb183-10" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb183-11"><a href="id_06_top_candidate_comparisons.html#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> ./other_data/goea.py <span class="at">-s</span> <span class="st">&quot;./other_data/top_candidates_gene_accession_3.csv&quot;</span> <span class="dt">\</span></span>
<span id="cb183-12"><a href="id_06_top_candidate_comparisons.html#cb183-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-p</span> <span class="st">&quot;./other_data/PlasmoDB-62_pfpv_GO.gaf&quot;</span> <span class="dt">\</span></span>
<span id="cb183-13"><a href="id_06_top_candidate_comparisons.html#cb183-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-n</span> <span class="st">&quot;./other_data/go-basic.obo&quot;</span> <span class="dt">\</span></span>
<span id="cb183-14"><a href="id_06_top_candidate_comparisons.html#cb183-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">-o</span> <span class="st">&quot;./other_data/goea_result_3.xlsx&quot;</span></span></code></pre></div>
</div>
<div id="plotting-5" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Plotting<a href="id_06_top_candidate_comparisons.html#plotting-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb184-1"><a href="id_06_top_candidate_comparisons.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb184-2"><a href="id_06_top_candidate_comparisons.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb184-3"><a href="id_06_top_candidate_comparisons.html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shadowtext)</span>
<span id="cb184-4"><a href="id_06_top_candidate_comparisons.html#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb184-5"><a href="id_06_top_candidate_comparisons.html#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb184-6"><a href="id_06_top_candidate_comparisons.html#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb184-7"><a href="id_06_top_candidate_comparisons.html#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb185-1"><a href="id_06_top_candidate_comparisons.html#cb185-1" aria-hidden="true" tabindex="-1"></a>process_goea_res <span class="ot">&lt;-</span> <span class="cf">function</span>(file_name) {</span>
<span id="cb185-2"><a href="id_06_top_candidate_comparisons.html#cb185-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_name, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&#39;</span><span class="sc">\&quot;</span><span class="st">&#39;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-3"><a href="id_06_top_candidate_comparisons.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate percentage from the ratio column</span></span>
<span id="cb185-4"><a href="id_06_top_candidate_comparisons.html#cb185-4" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>num_genes <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">as.integer</span>(<span class="fu">unlist</span>(<span class="fu">strsplit</span>(x[<span class="st">&quot;ratio_in_study&quot;</span>], <span class="st">&quot;/&quot;</span>))[<span class="dv">1</span>]))</span>
<span id="cb185-5"><a href="id_06_top_candidate_comparisons.html#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select for enrichment (e) data rows</span></span>
<span id="cb185-6"><a href="id_06_top_candidate_comparisons.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>enrichment <span class="sc">==</span> <span class="st">&quot;e&quot;</span>, ]</span>
<span id="cb185-7"><a href="id_06_top_candidate_comparisons.html#cb185-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-8"><a href="id_06_top_candidate_comparisons.html#cb185-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select for biological process (BP) data rows</span></span>
<span id="cb185-9"><a href="id_06_top_candidate_comparisons.html#cb185-9" aria-hidden="true" tabindex="-1"></a>  res_bp <span class="ot">&lt;-</span> data[data<span class="sc">$</span>NS <span class="sc">==</span> <span class="st">&quot;BP&quot;</span>, ]</span>
<span id="cb185-10"><a href="id_06_top_candidate_comparisons.html#cb185-10" aria-hidden="true" tabindex="-1"></a>  res_bp<span class="sc">$</span><span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(res_bp<span class="sc">$</span>p_fdr_bh)</span>
<span id="cb185-11"><a href="id_06_top_candidate_comparisons.html#cb185-11" aria-hidden="true" tabindex="-1"></a>  res_bp <span class="ot">&lt;-</span> res_bp[<span class="fu">order</span>(res_bp<span class="sc">$</span><span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span>), ]</span>
<span id="cb185-12"><a href="id_06_top_candidate_comparisons.html#cb185-12" aria-hidden="true" tabindex="-1"></a>  res_bp<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Biological process&quot;</span>, <span class="fu">nrow</span>(res_bp))</span>
<span id="cb185-13"><a href="id_06_top_candidate_comparisons.html#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="id_06_top_candidate_comparisons.html#cb185-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select for cellular component (CC) data rows</span></span>
<span id="cb185-15"><a href="id_06_top_candidate_comparisons.html#cb185-15" aria-hidden="true" tabindex="-1"></a>  res_cc <span class="ot">&lt;-</span> data[data<span class="sc">$</span>NS <span class="sc">==</span> <span class="st">&quot;CC&quot;</span>, ]</span>
<span id="cb185-16"><a href="id_06_top_candidate_comparisons.html#cb185-16" aria-hidden="true" tabindex="-1"></a>  res_cc<span class="sc">$</span><span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(res_cc<span class="sc">$</span>p_fdr_bh)</span>
<span id="cb185-17"><a href="id_06_top_candidate_comparisons.html#cb185-17" aria-hidden="true" tabindex="-1"></a>  res_cc <span class="ot">&lt;-</span> res_cc[<span class="fu">order</span>(res_cc<span class="sc">$</span><span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span>), ]</span>
<span id="cb185-18"><a href="id_06_top_candidate_comparisons.html#cb185-18" aria-hidden="true" tabindex="-1"></a>  res_cc<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Cellular component&quot;</span>, <span class="fu">nrow</span>(res_cc))</span>
<span id="cb185-19"><a href="id_06_top_candidate_comparisons.html#cb185-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-20"><a href="id_06_top_candidate_comparisons.html#cb185-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select for molecular function (MF) data rows</span></span>
<span id="cb185-21"><a href="id_06_top_candidate_comparisons.html#cb185-21" aria-hidden="true" tabindex="-1"></a>  res_mf <span class="ot">&lt;-</span> data[data<span class="sc">$</span>NS <span class="sc">==</span> <span class="st">&quot;MF&quot;</span>, ]</span>
<span id="cb185-22"><a href="id_06_top_candidate_comparisons.html#cb185-22" aria-hidden="true" tabindex="-1"></a>  res_mf<span class="sc">$</span><span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(res_mf<span class="sc">$</span>p_fdr_bh)</span>
<span id="cb185-23"><a href="id_06_top_candidate_comparisons.html#cb185-23" aria-hidden="true" tabindex="-1"></a>  res_mf <span class="ot">&lt;-</span> res_mf[<span class="fu">order</span>(res_mf<span class="sc">$</span><span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span>), ]</span>
<span id="cb185-24"><a href="id_06_top_candidate_comparisons.html#cb185-24" aria-hidden="true" tabindex="-1"></a>  res_mf<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Molecular function&quot;</span>, <span class="fu">nrow</span>(res_mf))</span>
<span id="cb185-25"><a href="id_06_top_candidate_comparisons.html#cb185-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-26"><a href="id_06_top_candidate_comparisons.html#cb185-26" aria-hidden="true" tabindex="-1"></a>  ds <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">list</span>(res_mf, res_cc, res_bp))</span>
<span id="cb185-27"><a href="id_06_top_candidate_comparisons.html#cb185-27" aria-hidden="true" tabindex="-1"></a>  ds<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(ds<span class="sc">$</span>name, <span class="at">levels =</span> ds<span class="sc">$</span>name)</span>
<span id="cb185-28"><a href="id_06_top_candidate_comparisons.html#cb185-28" aria-hidden="true" tabindex="-1"></a>  ds<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(ds<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Biological process&quot;</span>, <span class="st">&quot;Cellular component&quot;</span>, <span class="st">&quot;Molecular function&quot;</span>))</span>
<span id="cb185-29"><a href="id_06_top_candidate_comparisons.html#cb185-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-30"><a href="id_06_top_candidate_comparisons.html#cb185-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ds)</span>
<span id="cb185-31"><a href="id_06_top_candidate_comparisons.html#cb185-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb186-1"><a href="id_06_top_candidate_comparisons.html#cb186-1" aria-hidden="true" tabindex="-1"></a>ds_1 <span class="ot">&lt;-</span> <span class="fu">process_goea_res</span>(<span class="st">&quot;./other_data/goea_result_1.csv&quot;</span>)</span>
<span id="cb186-2"><a href="id_06_top_candidate_comparisons.html#cb186-2" aria-hidden="true" tabindex="-1"></a>ds_2 <span class="ot">&lt;-</span> <span class="fu">process_goea_res</span>(<span class="st">&quot;./other_data/goea_result_2.csv&quot;</span>)</span>
<span id="cb186-3"><a href="id_06_top_candidate_comparisons.html#cb186-3" aria-hidden="true" tabindex="-1"></a>ds_3 <span class="ot">&lt;-</span> <span class="fu">process_goea_res</span>(<span class="st">&quot;./other_data/goea_result_3.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb187-1"><a href="id_06_top_candidate_comparisons.html#cb187-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ds_1, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> <span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb187-2"><a href="id_06_top_candidate_comparisons.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb187-3"><a href="id_06_top_candidate_comparisons.html#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-4"><a href="id_06_top_candidate_comparisons.html#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.0f&quot;</span>, num_genes)), <span class="at">nudge_y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-5"><a href="id_06_top_candidate_comparisons.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">label_wrap</span>(<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb187-6"><a href="id_06_top_candidate_comparisons.html#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb187-7"><a href="id_06_top_candidate_comparisons.html#cb187-7" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">facet_col</span>(<span class="at">facets =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-8"><a href="id_06_top_candidate_comparisons.html#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb187-9"><a href="id_06_top_candidate_comparisons.html#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-10"><a href="id_06_top_candidate_comparisons.html#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-11"><a href="id_06_top_candidate_comparisons.html#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-12"><a href="id_06_top_candidate_comparisons.html#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb187-13"><a href="id_06_top_candidate_comparisons.html#cb187-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-14"><a href="id_06_top_candidate_comparisons.html#cb187-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb187-15"><a href="id_06_top_candidate_comparisons.html#cb187-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb187-16"><a href="id_06_top_candidate_comparisons.html#cb187-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">85</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb187-17"><a href="id_06_top_candidate_comparisons.html#cb187-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb187-18"><a href="id_06_top_candidate_comparisons.html#cb187-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb187-19"><a href="id_06_top_candidate_comparisons.html#cb187-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb187-20"><a href="id_06_top_candidate_comparisons.html#cb187-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb187-21"><a href="id_06_top_candidate_comparisons.html#cb187-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, )</span>
<span id="cb187-22"><a href="id_06_top_candidate_comparisons.html#cb187-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-23"><a href="id_06_top_candidate_comparisons.html#cb187-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-24"><a href="id_06_top_candidate_comparisons.html#cb187-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;-Log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span> <span class="st">&quot;FDR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb187-25"><a href="id_06_top_candidate_comparisons.html#cb187-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 1 (35 candidates)&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb188-1"><a href="id_06_top_candidate_comparisons.html#cb188-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ds_2, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> <span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb188-2"><a href="id_06_top_candidate_comparisons.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb188-3"><a href="id_06_top_candidate_comparisons.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-4"><a href="id_06_top_candidate_comparisons.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.0f&quot;</span>, num_genes)), <span class="at">nudge_y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-5"><a href="id_06_top_candidate_comparisons.html#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">label_wrap</span>(<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb188-6"><a href="id_06_top_candidate_comparisons.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb188-7"><a href="id_06_top_candidate_comparisons.html#cb188-7" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">facet_col</span>(<span class="at">facets =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-8"><a href="id_06_top_candidate_comparisons.html#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb188-9"><a href="id_06_top_candidate_comparisons.html#cb188-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb188-10"><a href="id_06_top_candidate_comparisons.html#cb188-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb188-11"><a href="id_06_top_candidate_comparisons.html#cb188-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb188-12"><a href="id_06_top_candidate_comparisons.html#cb188-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb188-13"><a href="id_06_top_candidate_comparisons.html#cb188-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb188-14"><a href="id_06_top_candidate_comparisons.html#cb188-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb188-15"><a href="id_06_top_candidate_comparisons.html#cb188-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb188-16"><a href="id_06_top_candidate_comparisons.html#cb188-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb188-17"><a href="id_06_top_candidate_comparisons.html#cb188-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb188-18"><a href="id_06_top_candidate_comparisons.html#cb188-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb188-19"><a href="id_06_top_candidate_comparisons.html#cb188-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb188-20"><a href="id_06_top_candidate_comparisons.html#cb188-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb188-21"><a href="id_06_top_candidate_comparisons.html#cb188-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, )</span>
<span id="cb188-22"><a href="id_06_top_candidate_comparisons.html#cb188-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb188-23"><a href="id_06_top_candidate_comparisons.html#cb188-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-24"><a href="id_06_top_candidate_comparisons.html#cb188-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;-Log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span> <span class="st">&quot;FDR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb188-25"><a href="id_06_top_candidate_comparisons.html#cb188-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 2 (116 candidates)&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb189-1"><a href="id_06_top_candidate_comparisons.html#cb189-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ds_3, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> <span class="st">`</span><span class="at">-Log10FDR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb189-2"><a href="id_06_top_candidate_comparisons.html#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb189-3"><a href="id_06_top_candidate_comparisons.html#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-4"><a href="id_06_top_candidate_comparisons.html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.0f&quot;</span>, num_genes)), <span class="at">nudge_y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-5"><a href="id_06_top_candidate_comparisons.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">label_wrap</span>(<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb189-6"><a href="id_06_top_candidate_comparisons.html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb189-7"><a href="id_06_top_candidate_comparisons.html#cb189-7" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">facet_col</span>(<span class="at">facets =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-8"><a href="id_06_top_candidate_comparisons.html#cb189-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb189-9"><a href="id_06_top_candidate_comparisons.html#cb189-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb189-10"><a href="id_06_top_candidate_comparisons.html#cb189-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb189-11"><a href="id_06_top_candidate_comparisons.html#cb189-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb189-12"><a href="id_06_top_candidate_comparisons.html#cb189-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb189-13"><a href="id_06_top_candidate_comparisons.html#cb189-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb189-14"><a href="id_06_top_candidate_comparisons.html#cb189-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb189-15"><a href="id_06_top_candidate_comparisons.html#cb189-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb189-16"><a href="id_06_top_candidate_comparisons.html#cb189-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb189-17"><a href="id_06_top_candidate_comparisons.html#cb189-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb189-18"><a href="id_06_top_candidate_comparisons.html#cb189-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb189-19"><a href="id_06_top_candidate_comparisons.html#cb189-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb189-20"><a href="id_06_top_candidate_comparisons.html#cb189-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, ),</span>
<span id="cb189-21"><a href="id_06_top_candidate_comparisons.html#cb189-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, )</span>
<span id="cb189-22"><a href="id_06_top_candidate_comparisons.html#cb189-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb189-23"><a href="id_06_top_candidate_comparisons.html#cb189-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-24"><a href="id_06_top_candidate_comparisons.html#cb189-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;-Log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span> <span class="st">&quot;FDR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb189-25"><a href="id_06_top_candidate_comparisons.html#cb189-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 3 (39 candidates)&quot;</span>)</span></code></pre></div>
<p><strong>Final plot</strong></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb190-1"><a href="id_06_top_candidate_comparisons.html#cb190-1" aria-hidden="true" tabindex="-1"></a>p_combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb190-2"><a href="id_06_top_candidate_comparisons.html#cb190-2" aria-hidden="true" tabindex="-1"></a>p_combined</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%2013.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="candidate-antigen-characterization" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Candidate antigen characterization<a href="id_06_top_candidate_comparisons.html#candidate-antigen-characterization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="processing-table" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Processing table<a href="id_06_top_candidate_comparisons.html#processing-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb191-1"><a href="id_06_top_candidate_comparisons.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb192-1"><a href="id_06_top_candidate_comparisons.html#cb192-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_5_pfpv_purf_oob_predictions.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb192-2"><a href="id_06_top_candidate_comparisons.html#cb192-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> prediction[<span class="fu">order</span>(<span class="sc">-</span>prediction<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>), ]</span>
<span id="cb192-3"><a href="id_06_top_candidate_comparisons.html#cb192-3" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> prediction[prediction<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span>[<span class="fu">sum</span>(prediction<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>]</span>
<span id="cb192-4"><a href="id_06_top_candidate_comparisons.html#cb192-4" aria-hidden="true" tabindex="-1"></a>labeled_pos <span class="ot">&lt;-</span> <span class="fu">rownames</span>(prediction)[prediction<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb192-5"><a href="id_06_top_candidate_comparisons.html#cb192-5" aria-hidden="true" tabindex="-1"></a>top_pfpv <span class="ot">&lt;-</span> <span class="fu">rownames</span>(prediction[prediction<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> prediction<span class="sc">$</span><span class="st">`</span><span class="at">OOB score filtered</span><span class="st">`</span> <span class="sc">&gt;=</span> threshold, ])</span></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb193-1"><a href="id_06_top_candidate_comparisons.html#cb193-1" aria-hidden="true" tabindex="-1"></a>pfpv_prox <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Downloads/pfpv_proximity_values.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb193-2"><a href="id_06_top_candidate_comparisons.html#cb193-2" aria-hidden="true" tabindex="-1"></a>pfpv_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pfpv_prox</span>
<span id="cb193-3"><a href="id_06_top_candidate_comparisons.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(pfpv_prox)</span>
<span id="cb193-4"><a href="id_06_top_candidate_comparisons.html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pfpv_dist) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(pfpv_dist)</span>
<span id="cb193-5"><a href="id_06_top_candidate_comparisons.html#cb193-5" aria-hidden="true" tabindex="-1"></a>pfpv_dist <span class="ot">&lt;-</span> pfpv_dist[, labeled_pos]</span></code></pre></div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb194-1"><a href="id_06_top_candidate_comparisons.html#cb194-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> prediction[<span class="fu">c</span>(labeled_pos, top_pfpv), <span class="st">&quot;OOB score filtered&quot;</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb194-2"><a href="id_06_top_candidate_comparisons.html#cb194-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(ds, <span class="st">&quot;Protein ID&quot;</span>)</span>
<span id="cb194-3"><a href="id_06_top_candidate_comparisons.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ds)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Score&quot;</span></span>
<span id="cb194-4"><a href="id_06_top_candidate_comparisons.html#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="id_06_top_candidate_comparisons.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add clustering groups</span></span>
<span id="cb194-6"><a href="id_06_top_candidate_comparisons.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span>
<span id="cb194-7"><a href="id_06_top_candidate_comparisons.html#cb194-7" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb194-8"><a href="id_06_top_candidate_comparisons.html#cb194-8" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Group[ds<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span> <span class="sc">%in%</span> protein_id_1] <span class="ot">&lt;-</span> <span class="st">&quot;Group 1&quot;</span></span>
<span id="cb194-9"><a href="id_06_top_candidate_comparisons.html#cb194-9" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Group[ds<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span> <span class="sc">%in%</span> protein_id_2] <span class="ot">&lt;-</span> <span class="st">&quot;Group 2&quot;</span></span>
<span id="cb194-10"><a href="id_06_top_candidate_comparisons.html#cb194-10" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Group[ds<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span> <span class="sc">%in%</span> protein_id_3] <span class="ot">&lt;-</span> <span class="st">&quot;Group 3&quot;</span></span>
<span id="cb194-11"><a href="id_06_top_candidate_comparisons.html#cb194-11" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Group[ds<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span> <span class="sc">%in%</span> labeled_pos] <span class="ot">&lt;-</span> <span class="st">&quot;Known antigen&quot;</span></span>
<span id="cb194-12"><a href="id_06_top_candidate_comparisons.html#cb194-12" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Group[ds<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb194-13"><a href="id_06_top_candidate_comparisons.html#cb194-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>,</span>
<span id="cb194-14"><a href="id_06_top_candidate_comparisons.html#cb194-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>,</span>
<span id="cb194-15"><a href="id_06_top_candidate_comparisons.html#cb194-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;PVP01_0835600.1-p1&quot;</span>, <span class="st">&quot;PVP01_0623800.1-p1&quot;</span>,</span>
<span id="cb194-16"><a href="id_06_top_candidate_comparisons.html#cb194-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;PVP01_0728900.1-p1&quot;</span></span>
<span id="cb194-17"><a href="id_06_top_candidate_comparisons.html#cb194-17" aria-hidden="true" tabindex="-1"></a>)] <span class="ot">&lt;-</span> <span class="st">&quot;Reference antigen&quot;</span></span>
<span id="cb194-18"><a href="id_06_top_candidate_comparisons.html#cb194-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-19"><a href="id_06_top_candidate_comparisons.html#cb194-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add gene products</span></span>
<span id="cb194-20"><a href="id_06_top_candidate_comparisons.html#cb194-20" aria-hidden="true" tabindex="-1"></a>gene_products <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb194-21"><a href="id_06_top_candidate_comparisons.html#cb194-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf3d7_gene_products_v62.csv&quot;</span>),</span>
<span id="cb194-22"><a href="id_06_top_candidate_comparisons.html#cb194-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pvp01_gene_products_v62.csv&quot;</span>)</span>
<span id="cb194-23"><a href="id_06_top_candidate_comparisons.html#cb194-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-24"><a href="id_06_top_candidate_comparisons.html#cb194-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gene_products) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Protein ID&quot;</span>, <span class="st">&quot;Gene product&quot;</span>)</span>
<span id="cb194-25"><a href="id_06_top_candidate_comparisons.html#cb194-25" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> ds, <span class="at">y =</span> gene_products, <span class="at">by =</span> <span class="st">&quot;Protein ID&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-26"><a href="id_06_top_candidate_comparisons.html#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="id_06_top_candidate_comparisons.html#cb194-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add closest reference antigen and the distance</span></span>
<span id="cb194-28"><a href="id_06_top_candidate_comparisons.html#cb194-28" aria-hidden="true" tabindex="-1"></a>pfpv_ad_ctrl_res <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pfpv_ad_ctrl_res.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb194-29"><a href="id_06_top_candidate_comparisons.html#cb194-29" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span><span class="st">`</span><span class="at">Closest known antigen</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb194-30"><a href="id_06_top_candidate_comparisons.html#cb194-30" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span><span class="st">`</span><span class="at">Known antigen source</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="st">&quot;Intersect&quot;</span></span>
<span id="cb194-31"><a href="id_06_top_candidate_comparisons.html#cb194-31" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span><span class="st">`</span><span class="at">Closest distance</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb194-32"><a href="id_06_top_candidate_comparisons.html#cb194-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ds)) {</span>
<span id="cb194-33"><a href="id_06_top_candidate_comparisons.html#cb194-33" aria-hidden="true" tabindex="-1"></a>  prot <span class="ot">&lt;-</span> ds<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span>[i]</span>
<span id="cb194-34"><a href="id_06_top_candidate_comparisons.html#cb194-34" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> pfpv_dist[prot, ]</span>
<span id="cb194-35"><a href="id_06_top_candidate_comparisons.html#cb194-35" aria-hidden="true" tabindex="-1"></a>  ds[i, <span class="st">&quot;Closest known antigen&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp)[<span class="fu">which.min</span>(tmp)]</span>
<span id="cb194-36"><a href="id_06_top_candidate_comparisons.html#cb194-36" aria-hidden="true" tabindex="-1"></a>  ds[i, <span class="st">&quot;Closest known antigen&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb194-37"><a href="id_06_top_candidate_comparisons.html#cb194-37" aria-hidden="true" tabindex="-1"></a>    ds[i, <span class="st">&quot;Closest known antigen&quot;</span>], <span class="st">&quot; (&quot;</span>,</span>
<span id="cb194-38"><a href="id_06_top_candidate_comparisons.html#cb194-38" aria-hidden="true" tabindex="-1"></a>    gene_products[</span>
<span id="cb194-39"><a href="id_06_top_candidate_comparisons.html#cb194-39" aria-hidden="true" tabindex="-1"></a>      gene_products<span class="sc">$</span><span class="st">`</span><span class="at">Protein ID</span><span class="st">`</span> <span class="sc">==</span> ds[i, <span class="st">&quot;Closest known antigen&quot;</span>],</span>
<span id="cb194-40"><a href="id_06_top_candidate_comparisons.html#cb194-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Gene product&quot;</span></span>
<span id="cb194-41"><a href="id_06_top_candidate_comparisons.html#cb194-41" aria-hidden="true" tabindex="-1"></a>    ], <span class="st">&quot;)&quot;</span></span>
<span id="cb194-42"><a href="id_06_top_candidate_comparisons.html#cb194-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb194-43"><a href="id_06_top_candidate_comparisons.html#cb194-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">names</span>(tmp)[<span class="fu">which.min</span>(tmp)] <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb194-44"><a href="id_06_top_candidate_comparisons.html#cb194-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>,</span>
<span id="cb194-45"><a href="id_06_top_candidate_comparisons.html#cb194-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>,</span>
<span id="cb194-46"><a href="id_06_top_candidate_comparisons.html#cb194-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;PVP01_0835600.1-p1&quot;</span>, <span class="st">&quot;PVP01_0623800.1-p1&quot;</span>,</span>
<span id="cb194-47"><a href="id_06_top_candidate_comparisons.html#cb194-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;PVP01_0728900.1-p1&quot;</span></span>
<span id="cb194-48"><a href="id_06_top_candidate_comparisons.html#cb194-48" aria-hidden="true" tabindex="-1"></a>  )) {</span>
<span id="cb194-49"><a href="id_06_top_candidate_comparisons.html#cb194-49" aria-hidden="true" tabindex="-1"></a>    ds[i, <span class="st">&quot;Known antigen source&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Reference&quot;</span></span>
<span id="cb194-50"><a href="id_06_top_candidate_comparisons.html#cb194-50" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb194-51"><a href="id_06_top_candidate_comparisons.html#cb194-51" aria-hidden="true" tabindex="-1"></a>    ds[i, <span class="st">&quot;Known antigen source&quot;</span>] <span class="ot">&lt;-</span> pfpv_ad_ctrl_res[<span class="fu">names</span>(tmp)[<span class="fu">which.min</span>(tmp)], <span class="st">&quot;source&quot;</span>]</span>
<span id="cb194-52"><a href="id_06_top_candidate_comparisons.html#cb194-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-53"><a href="id_06_top_candidate_comparisons.html#cb194-53" aria-hidden="true" tabindex="-1"></a>  ds[i, <span class="st">&quot;Closest distance&quot;</span>] <span class="ot">&lt;-</span> tmp[<span class="fu">which.min</span>(tmp)]</span>
<span id="cb194-54"><a href="id_06_top_candidate_comparisons.html#cb194-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-55"><a href="id_06_top_candidate_comparisons.html#cb194-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-56"><a href="id_06_top_candidate_comparisons.html#cb194-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on scores</span></span>
<span id="cb194-57"><a href="id_06_top_candidate_comparisons.html#cb194-57" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds[<span class="fu">order</span>(<span class="sc">-</span>ds<span class="sc">$</span>Score), ]</span>
<span id="cb194-58"><a href="id_06_top_candidate_comparisons.html#cb194-58" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ds, <span class="at">file =</span> <span class="st">&quot;./data/supplementary_data_6_antigen_characterization.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb195-1"><a href="id_06_top_candidate_comparisons.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tibble_3.2.1     scales_1.2.1     reshape_0.8.9    ggforce_0.4.1   
##  [5] shadowtext_0.1.2 gridExtra_2.3    ggrepel_0.9.3    umap_0.2.10.0   
##  [9] cowplot_1.1.1    cluster_2.1.4    NbClust_3.0.1    factoextra_1.0.7
## [13] ggplot2_3.4.2    DT_0.27         
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.10       lattice_0.21-8    png_0.1-8         digest_0.6.31    
##  [5] utf8_1.2.3        RSpectra_0.16-1   R6_2.5.1          plyr_1.8.8       
##  [9] evaluate_0.21     highr_0.10        pillar_1.9.0      rlang_1.1.1      
## [13] rstudioapi_0.14   jquerylib_0.1.4   R.utils_2.12.2    R.oo_1.25.0      
## [17] Matrix_1.5-4      reticulate_1.28   rmarkdown_2.21    styler_1.9.1     
## [21] htmlwidgets_1.6.2 polyclip_1.10-4   munsell_0.5.0     compiler_4.2.3   
## [25] xfun_0.39         pkgconfig_2.0.3   askpass_1.1       htmltools_0.5.5  
## [29] openssl_2.0.6     tidyselect_1.2.0  bookdown_0.34     codetools_0.2-19 
## [33] fansi_1.0.4       dplyr_1.1.2       withr_2.5.0       MASS_7.3-60      
## [37] R.methodsS3_1.8.2 grid_4.2.3        jsonlite_1.8.4    gtable_0.3.3     
## [41] lifecycle_1.0.3   magrittr_2.0.3    cli_3.6.1         cachem_1.0.8     
## [45] farver_2.1.1      bslib_0.4.2       generics_0.1.3    vctrs_0.6.2      
## [49] tools_4.2.3       R.cache_0.16.0    glue_1.6.2        tweenr_2.0.2     
## [53] purrr_1.0.1       fastmap_1.1.1     yaml_2.3.7        colorspace_2.1-0 
## [57] knitr_1.42        sass_0.4.6</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_05_model_interpretation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="id_07_summary_of_candidates.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["main_notebook.pdf", "PDF"]],
"search": false,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
